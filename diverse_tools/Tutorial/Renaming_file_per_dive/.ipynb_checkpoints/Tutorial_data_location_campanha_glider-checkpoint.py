{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "a82d8275",
   "metadata": {
    "editable": true,
    "slideshow": {
     "slide_type": ""
    },
    "tags": []
   },
   "source": [
    "# Importando módulos "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "36e98d84",
   "metadata": {},
   "outputs": [],
   "source": [
    "import obspy\n",
    "from obspy.taup import TauPyModel\n",
    "\n",
    "from multiprocessing import Pool\n",
    "from obspy import read,UTCDateTime,Trace\n",
    "from obspy.clients.fdsn import Client\n",
    "import os\n",
    "import glob\n",
    "import numpy as np\n",
    "from collections import defaultdict\n",
    "import pandas as pd\n",
    "\n",
    "#para plotar as figuras\n",
    "import matplotlib.pyplot as plt\n",
    "from matplotlib.transforms import offset_copy\n",
    "import matplotlib.ticker as ticker\n",
    "from mpl_toolkits.axes_grid1 import make_axes_locatable\n",
    "from matplotlib.colors import ListedColormap\n",
    "import matplotlib.dates as mdates\n",
    "from mpl_toolkits.axes_grid1.inset_locator import InsetPosition,inset_axes\n",
    "import matplotlib.colors as colors\n",
    "import matplotlib.cm as cm\n",
    "from matplotlib.dates import YearLocator, MonthLocator, DayLocator, HourLocator, MinuteLocator, SecondLocator, DateFormatter\n",
    "from matplotlib.ticker import MultipleLocator, FormatStrFormatter\n",
    "\n",
    "from datetime import datetime,timedelta,date\n",
    "from tqdm import tqdm\n",
    "\n",
    "from shapely.geometry.polygon import LinearRing\n",
    "\n",
    "import cartopy.io.shapereader as shpreader\n",
    "import cartopy.crs as ccrs\n",
    "import cartopy.feature as cfeature\n",
    "\n",
    "from IPython.display import HTML\n",
    "from IPython import display"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "5b4f9f8f",
   "metadata": {},
   "source": [
    "# Inputs e Outputs"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "38736b57",
   "metadata": {},
   "outputs": [],
   "source": [
    "FOLDER_OUTPUT = '/media/sysop/8d2362fc-3b46-49a7-a864-19b2a6ad097b/diogoloc/dados_posdoc/gliders_project/OUTPUT/'\n",
    "\n",
    "MSEED_INPUT = \"/media/sysop/8d2362fc-3b46-49a7-a864-19b2a6ad097b/diogoloc/dados_posdoc/gliders_project/OUTPUT/MSEED/\"\n",
    "\n",
    "METADATA_OUTPUT = \"/media/sysop/8d2362fc-3b46-49a7-a864-19b2a6ad097b/diogoloc/dados_posdoc/gliders_project/OUTPUT/METADATA/\"\n",
    "\n",
    "filename_csv = '/media/sysop/8d2362fc-3b46-49a7-a864-19b2a6ad097b/diogoloc/dados_posdoc/gliders_project/gliders_data/info_csv/metadados_glider_acustico_pmpas-bs.csv'\n",
    "\n",
    "campanha_csv = '/media/sysop/8d2362fc-3b46-49a7-a864-19b2a6ad097b/diogoloc/dados_posdoc/gliders_project/Equipamentos/informacoes_sensores_gliders/Dados_campanhas_Gliders.xls'"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "9ebce2fe",
   "metadata": {},
   "source": [
    "# Extraindo informações dos arquivos \".mseed\" reamostrados"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "95a67b2b",
   "metadata": {},
   "outputs": [],
   "source": [
    "filenames_MSEED = sorted(glob.glob(MSEED_INPUT+'*/*/*.mseed'))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "d2378588",
   "metadata": {},
   "outputs": [],
   "source": [
    "def mseed_data_2_dataframe(i):\n",
    "    subdir, filename_wav = os.path.split(i)\n",
    "    root_file = i\n",
    "    filename = filename_wav.split('.mseed')[0]\n",
    "    if 'pa' in filename.split('_')[0]:\n",
    "        mergulho = filename.split('_')[0].split('a')[1]\n",
    "        stream_number = filename.split('_')[1]\n",
    "\n",
    "        year_month_day = filename.split('_')[2]\n",
    "        hour_minute_second = filename.split('_')[3]\n",
    "\n",
    "        year = int('20'+year_month_day[:2])\n",
    "        month = int(year_month_day[2:4])\n",
    "        day = int(year_month_day[4:])\n",
    "\n",
    "        hour = int(hour_minute_second[:2])\n",
    "        minute = int(hour_minute_second[2:4])\n",
    "        second = int(hour_minute_second[4:])\n",
    "\n",
    "        d = UTCDateTime(datetime(year,month,day,hour,minute,second).isoformat())\n",
    "\n",
    "\n",
    "    if 'pa' in filename.split('_')[2]:\n",
    "\n",
    "        mergulho = filename.split('_')[2].split('a')[1]\n",
    "        stream_number = filename.split('_')[3]\n",
    "\n",
    "        year_month_day = filename.split('_')[0]\n",
    "        hour_minute_second = filename.split('_')[1]\n",
    "\n",
    "        year = int('20'+year_month_day[:2])\n",
    "        month = int(year_month_day[2:4])\n",
    "        day = int(year_month_day[4:])\n",
    "\n",
    "        hour = int(hour_minute_second[:2])\n",
    "        minute = int(hour_minute_second[2:4])\n",
    "        second = int(hour_minute_second[4:])\n",
    "\n",
    "        d = UTCDateTime(datetime(year,month,day,hour,minute,second).isoformat())\n",
    "        \n",
    "    \n",
    "    st = read(i,headonly=True)   \n",
    "    #----------------------------\n",
    "    #Starting Dataframe\n",
    "\n",
    "    starttime = st[0].stats.starttime.datetime\n",
    "    endtime = st[0].stats.endtime.datetime\n",
    "    sampling_rate = st[0].stats.sampling_rate\n",
    "    npts = st[0].stats.npts\n",
    "\n",
    "    \n",
    "    df = pd.DataFrame([[root_file],[filename],[mergulho],[stream_number],[starttime],[endtime],[sampling_rate],[npts]], index=['root_file','filename_mseed', 'mergulho', 'stream_number','starttime','endtime','sampling_rate','npts']).T\n",
    "    \n",
    "    #Ending Dataframe\n",
    "    #----------------------------\n",
    "    return df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "de4c7652",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 124257/124257 [09:23<00:00, 220.56it/s]\n"
     ]
    }
   ],
   "source": [
    "pandas_mseed_lst = []\n",
    "\n",
    "with Pool(processes=8) as p:\n",
    "    max_ = len(filenames_MSEED)\n",
    "    with tqdm(total=max_) as pbar:\n",
    "        for result in p.imap_unordered(mseed_data_2_dataframe,filenames_MSEED):\n",
    "            pbar.update()\n",
    "            pandas_mseed_lst.append(result)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "d1380549",
   "metadata": {},
   "outputs": [],
   "source": [
    "dataframe_mseed_final = pd.concat(pandas_mseed_lst, ignore_index=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "c3dc41a0",
   "metadata": {},
   "outputs": [],
   "source": [
    "dataframe_mseed_final['starttime'] = pd.to_datetime(dataframe_mseed_final.starttime, format='%Y-%m-%d %H:%M:%S')\n",
    "dataframe_mseed_final['endtime'] = pd.to_datetime(dataframe_mseed_final.endtime, format='%Y-%m-%d %H:%M:%S')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "424dc605",
   "metadata": {},
   "outputs": [],
   "source": [
    "dataframe_mseed_final['date'] = dataframe_mseed_final['starttime'].dt.date"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "610fe37a",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>root_file,</th>\n",
       "      <th>filename_mseed</th>\n",
       "      <th>mergulho</th>\n",
       "      <th>stream_number</th>\n",
       "      <th>starttime</th>\n",
       "      <th>endtime</th>\n",
       "      <th>sampling_rate</th>\n",
       "      <th>npts</th>\n",
       "      <th>date</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>/media/sysop/8d2362fc-3b46-49a7-a864-19b2a6ad0...</td>\n",
       "      <td>pa0002au_002_151112_143818</td>\n",
       "      <td>0002</td>\n",
       "      <td>002</td>\n",
       "      <td>2015-11-12 14:38:18</td>\n",
       "      <td>2015-11-12 14:40:17.930</td>\n",
       "      <td>100.0</td>\n",
       "      <td>11994</td>\n",
       "      <td>2015-11-12</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>/media/sysop/8d2362fc-3b46-49a7-a864-19b2a6ad0...</td>\n",
       "      <td>pa0002au_004_151112_144218</td>\n",
       "      <td>0002</td>\n",
       "      <td>004</td>\n",
       "      <td>2015-11-12 14:42:18</td>\n",
       "      <td>2015-11-12 14:44:17.930</td>\n",
       "      <td>100.0</td>\n",
       "      <td>11994</td>\n",
       "      <td>2015-11-12</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>/media/sysop/8d2362fc-3b46-49a7-a864-19b2a6ad0...</td>\n",
       "      <td>pa0002au_005_151112_144418</td>\n",
       "      <td>0002</td>\n",
       "      <td>005</td>\n",
       "      <td>2015-11-12 14:44:18</td>\n",
       "      <td>2015-11-12 14:46:17.930</td>\n",
       "      <td>100.0</td>\n",
       "      <td>11994</td>\n",
       "      <td>2015-11-12</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>/media/sysop/8d2362fc-3b46-49a7-a864-19b2a6ad0...</td>\n",
       "      <td>pa0002au_006_151112_144618</td>\n",
       "      <td>0002</td>\n",
       "      <td>006</td>\n",
       "      <td>2015-11-12 14:46:18</td>\n",
       "      <td>2015-11-12 14:48:17.930</td>\n",
       "      <td>100.0</td>\n",
       "      <td>11994</td>\n",
       "      <td>2015-11-12</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>/media/sysop/8d2362fc-3b46-49a7-a864-19b2a6ad0...</td>\n",
       "      <td>pa0002au_007_151112_144818</td>\n",
       "      <td>0002</td>\n",
       "      <td>007</td>\n",
       "      <td>2015-11-12 14:48:18</td>\n",
       "      <td>2015-11-12 14:50:17.930</td>\n",
       "      <td>100.0</td>\n",
       "      <td>11994</td>\n",
       "      <td>2015-11-12</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>124252</th>\n",
       "      <td>/media/sysop/8d2362fc-3b46-49a7-a864-19b2a6ad0...</td>\n",
       "      <td>pa0296au_010_211104_063338</td>\n",
       "      <td>0296</td>\n",
       "      <td>010</td>\n",
       "      <td>2021-11-04 06:33:38</td>\n",
       "      <td>2021-11-04 06:43:37.990</td>\n",
       "      <td>100.0</td>\n",
       "      <td>60000</td>\n",
       "      <td>2021-11-04</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>124253</th>\n",
       "      <td>/media/sysop/8d2362fc-3b46-49a7-a864-19b2a6ad0...</td>\n",
       "      <td>pa0295au_012_211104_021556</td>\n",
       "      <td>0295</td>\n",
       "      <td>012</td>\n",
       "      <td>2021-11-04 02:15:56</td>\n",
       "      <td>2021-11-04 02:19:41.910</td>\n",
       "      <td>100.0</td>\n",
       "      <td>22592</td>\n",
       "      <td>2021-11-04</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>124254</th>\n",
       "      <td>/media/sysop/8d2362fc-3b46-49a7-a864-19b2a6ad0...</td>\n",
       "      <td>pa0296au_012_211104_065338</td>\n",
       "      <td>0296</td>\n",
       "      <td>012</td>\n",
       "      <td>2021-11-04 06:53:38</td>\n",
       "      <td>2021-11-04 06:57:21.780</td>\n",
       "      <td>100.0</td>\n",
       "      <td>22379</td>\n",
       "      <td>2021-11-04</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>124255</th>\n",
       "      <td>/media/sysop/8d2362fc-3b46-49a7-a864-19b2a6ad0...</td>\n",
       "      <td>pa0296au_005_211104_054338</td>\n",
       "      <td>0296</td>\n",
       "      <td>005</td>\n",
       "      <td>2021-11-04 05:43:38</td>\n",
       "      <td>2021-11-04 05:53:37.990</td>\n",
       "      <td>100.0</td>\n",
       "      <td>60000</td>\n",
       "      <td>2021-11-04</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>124256</th>\n",
       "      <td>/media/sysop/8d2362fc-3b46-49a7-a864-19b2a6ad0...</td>\n",
       "      <td>pa0296au_011_211104_064338</td>\n",
       "      <td>0296</td>\n",
       "      <td>011</td>\n",
       "      <td>2021-11-04 06:43:38</td>\n",
       "      <td>2021-11-04 06:53:37.990</td>\n",
       "      <td>100.0</td>\n",
       "      <td>60000</td>\n",
       "      <td>2021-11-04</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>124257 rows × 9 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                                               root_file,  \\\n",
       "0       /media/sysop/8d2362fc-3b46-49a7-a864-19b2a6ad0...   \n",
       "1       /media/sysop/8d2362fc-3b46-49a7-a864-19b2a6ad0...   \n",
       "2       /media/sysop/8d2362fc-3b46-49a7-a864-19b2a6ad0...   \n",
       "3       /media/sysop/8d2362fc-3b46-49a7-a864-19b2a6ad0...   \n",
       "4       /media/sysop/8d2362fc-3b46-49a7-a864-19b2a6ad0...   \n",
       "...                                                   ...   \n",
       "124252  /media/sysop/8d2362fc-3b46-49a7-a864-19b2a6ad0...   \n",
       "124253  /media/sysop/8d2362fc-3b46-49a7-a864-19b2a6ad0...   \n",
       "124254  /media/sysop/8d2362fc-3b46-49a7-a864-19b2a6ad0...   \n",
       "124255  /media/sysop/8d2362fc-3b46-49a7-a864-19b2a6ad0...   \n",
       "124256  /media/sysop/8d2362fc-3b46-49a7-a864-19b2a6ad0...   \n",
       "\n",
       "                    filename_mseed mergulho stream_number           starttime  \\\n",
       "0       pa0002au_002_151112_143818     0002           002 2015-11-12 14:38:18   \n",
       "1       pa0002au_004_151112_144218     0002           004 2015-11-12 14:42:18   \n",
       "2       pa0002au_005_151112_144418     0002           005 2015-11-12 14:44:18   \n",
       "3       pa0002au_006_151112_144618     0002           006 2015-11-12 14:46:18   \n",
       "4       pa0002au_007_151112_144818     0002           007 2015-11-12 14:48:18   \n",
       "...                            ...      ...           ...                 ...   \n",
       "124252  pa0296au_010_211104_063338     0296           010 2021-11-04 06:33:38   \n",
       "124253  pa0295au_012_211104_021556     0295           012 2021-11-04 02:15:56   \n",
       "124254  pa0296au_012_211104_065338     0296           012 2021-11-04 06:53:38   \n",
       "124255  pa0296au_005_211104_054338     0296           005 2021-11-04 05:43:38   \n",
       "124256  pa0296au_011_211104_064338     0296           011 2021-11-04 06:43:38   \n",
       "\n",
       "                       endtime sampling_rate   npts        date  \n",
       "0      2015-11-12 14:40:17.930         100.0  11994  2015-11-12  \n",
       "1      2015-11-12 14:44:17.930         100.0  11994  2015-11-12  \n",
       "2      2015-11-12 14:46:17.930         100.0  11994  2015-11-12  \n",
       "3      2015-11-12 14:48:17.930         100.0  11994  2015-11-12  \n",
       "4      2015-11-12 14:50:17.930         100.0  11994  2015-11-12  \n",
       "...                        ...           ...    ...         ...  \n",
       "124252 2021-11-04 06:43:37.990         100.0  60000  2021-11-04  \n",
       "124253 2021-11-04 02:19:41.910         100.0  22592  2021-11-04  \n",
       "124254 2021-11-04 06:57:21.780         100.0  22379  2021-11-04  \n",
       "124255 2021-11-04 05:53:37.990         100.0  60000  2021-11-04  \n",
       "124256 2021-11-04 06:53:37.990         100.0  60000  2021-11-04  \n",
       "\n",
       "[124257 rows x 9 columns]"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "dataframe_mseed_final"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "a9776f1c-32f6-424c-9bcc-cf9a6bf73fd5",
   "metadata": {},
   "source": [
    "# Extraindo informações do arquivo \".csv\" com as campanhas"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "27694c87-c7a8-41ac-b1b7-18817053fbda",
   "metadata": {},
   "outputs": [],
   "source": [
    "ciclos_dataframe_csv = pd.read_excel(campanha_csv)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "da9b0117-1639-4e39-b7e1-c05b92999130",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Sistema</th>\n",
       "      <th>Ciclo</th>\n",
       "      <th>starttime</th>\n",
       "      <th>endtime</th>\n",
       "      <th>Fs</th>\n",
       "      <th>nBits</th>\n",
       "      <th>Hidrofone</th>\n",
       "      <th>PreAmp</th>\n",
       "      <th>N/S</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>GLIDER</td>\n",
       "      <td>1</td>\n",
       "      <td>2015-11-10</td>\n",
       "      <td>2015-12-20</td>\n",
       "      <td>125000</td>\n",
       "      <td>16</td>\n",
       "      <td>911006</td>\n",
       "      <td>1501</td>\n",
       "      <td>SG618</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>GLIDER</td>\n",
       "      <td>2</td>\n",
       "      <td>2016-01-08</td>\n",
       "      <td>2016-02-02</td>\n",
       "      <td>125000</td>\n",
       "      <td>16</td>\n",
       "      <td>911006</td>\n",
       "      <td>1501</td>\n",
       "      <td>SG618</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>GLIDER</td>\n",
       "      <td>3</td>\n",
       "      <td>2016-02-02</td>\n",
       "      <td>2016-04-20</td>\n",
       "      <td>125000</td>\n",
       "      <td>24</td>\n",
       "      <td>911008</td>\n",
       "      <td>1503</td>\n",
       "      <td>SG612</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>GLIDER</td>\n",
       "      <td>4</td>\n",
       "      <td>2016-04-20</td>\n",
       "      <td>2016-07-07</td>\n",
       "      <td>125000</td>\n",
       "      <td>24</td>\n",
       "      <td>911006</td>\n",
       "      <td>1501</td>\n",
       "      <td>SG612</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>GLIDER</td>\n",
       "      <td>5</td>\n",
       "      <td>2016-07-07</td>\n",
       "      <td>2016-08-16</td>\n",
       "      <td>125000</td>\n",
       "      <td>24</td>\n",
       "      <td>911008</td>\n",
       "      <td>1503</td>\n",
       "      <td>SG612</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>89</th>\n",
       "      <td>GLIDER</td>\n",
       "      <td>MC_C026</td>\n",
       "      <td>2023-06-22</td>\n",
       "      <td>2023-07-30</td>\n",
       "      <td>128000</td>\n",
       "      <td>24</td>\n",
       "      <td>G003654</td>\n",
       "      <td>AMAR-G4</td>\n",
       "      <td>SL976</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>90</th>\n",
       "      <td>GLIDER</td>\n",
       "      <td>ME_C012</td>\n",
       "      <td>2023-06-20</td>\n",
       "      <td>2023-08-01</td>\n",
       "      <td>128000</td>\n",
       "      <td>24</td>\n",
       "      <td>C000811</td>\n",
       "      <td>AMAR-G4</td>\n",
       "      <td>SL977</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>91</th>\n",
       "      <td>GLIDER</td>\n",
       "      <td>MC_C027</td>\n",
       "      <td>2023-12-30</td>\n",
       "      <td>2023-12-30</td>\n",
       "      <td>128000</td>\n",
       "      <td>24</td>\n",
       "      <td>G003654</td>\n",
       "      <td>AMAR-G4</td>\n",
       "      <td>SL975</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>92</th>\n",
       "      <td>GLIDER</td>\n",
       "      <td>MC_C028</td>\n",
       "      <td>2023-08-03</td>\n",
       "      <td>2023-09-09</td>\n",
       "      <td>128000</td>\n",
       "      <td>24</td>\n",
       "      <td>F001108</td>\n",
       "      <td>AMAR-G4</td>\n",
       "      <td>SL977</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>93</th>\n",
       "      <td>GLIDER</td>\n",
       "      <td>MC_C029</td>\n",
       "      <td>2023-09-24</td>\n",
       "      <td>2023-10-05</td>\n",
       "      <td>128000</td>\n",
       "      <td>24</td>\n",
       "      <td>I000091</td>\n",
       "      <td>AMAR-G4</td>\n",
       "      <td>SL1099</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>94 rows × 9 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "   Sistema    Ciclo  starttime    endtime      Fs  nBits Hidrofone   PreAmp  \\\n",
       "0   GLIDER        1 2015-11-10 2015-12-20  125000     16    911006     1501   \n",
       "1   GLIDER        2 2016-01-08 2016-02-02  125000     16    911006     1501   \n",
       "2   GLIDER        3 2016-02-02 2016-04-20  125000     24    911008     1503   \n",
       "3   GLIDER        4 2016-04-20 2016-07-07  125000     24    911006     1501   \n",
       "4   GLIDER        5 2016-07-07 2016-08-16  125000     24    911008     1503   \n",
       "..     ...      ...        ...        ...     ...    ...       ...      ...   \n",
       "89  GLIDER  MC_C026 2023-06-22 2023-07-30  128000     24   G003654  AMAR-G4   \n",
       "90  GLIDER  ME_C012 2023-06-20 2023-08-01  128000     24   C000811  AMAR-G4   \n",
       "91  GLIDER  MC_C027 2023-12-30 2023-12-30  128000     24   G003654  AMAR-G4   \n",
       "92  GLIDER  MC_C028 2023-08-03 2023-09-09  128000     24   F001108  AMAR-G4   \n",
       "93  GLIDER  MC_C029 2023-09-24 2023-10-05  128000     24   I000091  AMAR-G4   \n",
       "\n",
       "       N/S  \n",
       "0    SG618  \n",
       "1    SG618  \n",
       "2    SG612  \n",
       "3    SG612  \n",
       "4    SG612  \n",
       "..     ...  \n",
       "89   SL976  \n",
       "90   SL977  \n",
       "91   SL975  \n",
       "92   SL977  \n",
       "93  SL1099  \n",
       "\n",
       "[94 rows x 9 columns]"
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "ciclos_dataframe_csv"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "b1255d12-a70a-4255-a4e0-83d110d72594",
   "metadata": {},
   "outputs": [],
   "source": [
    "ciclos_dataframe_csv['starttime'] = pd.to_datetime(ciclos_dataframe_csv.starttime, format='%Y-%m-%d %H:%M:%S').dt.date\n",
    "ciclos_dataframe_csv['endtime'] = pd.to_datetime(ciclos_dataframe_csv.endtime, format='%Y-%m-%d %H:%M:%S').dt.date"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "75ed0916-e566-4e45-853c-f77ee387cde2",
   "metadata": {},
   "outputs": [],
   "source": [
    "ciclos_dataframe_csv['Ciclo_new'] = range(len(ciclos_dataframe_csv))\n",
    "ciclos_dataframe_csv['Hidrofone'] = ciclos_dataframe_csv['Hidrofone'].astype(str)\n",
    "ciclos_dataframe_csv['PreAmp'] = ciclos_dataframe_csv['PreAmp'].astype(str)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "id": "1c39a048-f1a2-4990-825c-bff619db6268",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Sistema</th>\n",
       "      <th>Ciclo</th>\n",
       "      <th>starttime</th>\n",
       "      <th>endtime</th>\n",
       "      <th>Fs</th>\n",
       "      <th>nBits</th>\n",
       "      <th>Hidrofone</th>\n",
       "      <th>PreAmp</th>\n",
       "      <th>N/S</th>\n",
       "      <th>Ciclo_new</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>GLIDER</td>\n",
       "      <td>1</td>\n",
       "      <td>2015-11-10</td>\n",
       "      <td>2015-12-20</td>\n",
       "      <td>125000</td>\n",
       "      <td>16</td>\n",
       "      <td>911006</td>\n",
       "      <td>1501</td>\n",
       "      <td>SG618</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>GLIDER</td>\n",
       "      <td>2</td>\n",
       "      <td>2016-01-08</td>\n",
       "      <td>2016-02-02</td>\n",
       "      <td>125000</td>\n",
       "      <td>16</td>\n",
       "      <td>911006</td>\n",
       "      <td>1501</td>\n",
       "      <td>SG618</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>GLIDER</td>\n",
       "      <td>3</td>\n",
       "      <td>2016-02-02</td>\n",
       "      <td>2016-04-20</td>\n",
       "      <td>125000</td>\n",
       "      <td>24</td>\n",
       "      <td>911008</td>\n",
       "      <td>1503</td>\n",
       "      <td>SG612</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>GLIDER</td>\n",
       "      <td>4</td>\n",
       "      <td>2016-04-20</td>\n",
       "      <td>2016-07-07</td>\n",
       "      <td>125000</td>\n",
       "      <td>24</td>\n",
       "      <td>911006</td>\n",
       "      <td>1501</td>\n",
       "      <td>SG612</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>GLIDER</td>\n",
       "      <td>5</td>\n",
       "      <td>2016-07-07</td>\n",
       "      <td>2016-08-16</td>\n",
       "      <td>125000</td>\n",
       "      <td>24</td>\n",
       "      <td>911008</td>\n",
       "      <td>1503</td>\n",
       "      <td>SG612</td>\n",
       "      <td>4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>89</th>\n",
       "      <td>GLIDER</td>\n",
       "      <td>MC_C026</td>\n",
       "      <td>2023-06-22</td>\n",
       "      <td>2023-07-30</td>\n",
       "      <td>128000</td>\n",
       "      <td>24</td>\n",
       "      <td>G003654</td>\n",
       "      <td>AMAR-G4</td>\n",
       "      <td>SL976</td>\n",
       "      <td>89</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>90</th>\n",
       "      <td>GLIDER</td>\n",
       "      <td>ME_C012</td>\n",
       "      <td>2023-06-20</td>\n",
       "      <td>2023-08-01</td>\n",
       "      <td>128000</td>\n",
       "      <td>24</td>\n",
       "      <td>C000811</td>\n",
       "      <td>AMAR-G4</td>\n",
       "      <td>SL977</td>\n",
       "      <td>90</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>91</th>\n",
       "      <td>GLIDER</td>\n",
       "      <td>MC_C027</td>\n",
       "      <td>2023-12-30</td>\n",
       "      <td>2023-12-30</td>\n",
       "      <td>128000</td>\n",
       "      <td>24</td>\n",
       "      <td>G003654</td>\n",
       "      <td>AMAR-G4</td>\n",
       "      <td>SL975</td>\n",
       "      <td>91</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>92</th>\n",
       "      <td>GLIDER</td>\n",
       "      <td>MC_C028</td>\n",
       "      <td>2023-08-03</td>\n",
       "      <td>2023-09-09</td>\n",
       "      <td>128000</td>\n",
       "      <td>24</td>\n",
       "      <td>F001108</td>\n",
       "      <td>AMAR-G4</td>\n",
       "      <td>SL977</td>\n",
       "      <td>92</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>93</th>\n",
       "      <td>GLIDER</td>\n",
       "      <td>MC_C029</td>\n",
       "      <td>2023-09-24</td>\n",
       "      <td>2023-10-05</td>\n",
       "      <td>128000</td>\n",
       "      <td>24</td>\n",
       "      <td>I000091</td>\n",
       "      <td>AMAR-G4</td>\n",
       "      <td>SL1099</td>\n",
       "      <td>93</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>94 rows × 10 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "   Sistema    Ciclo   starttime     endtime      Fs  nBits Hidrofone   PreAmp  \\\n",
       "0   GLIDER        1  2015-11-10  2015-12-20  125000     16    911006     1501   \n",
       "1   GLIDER        2  2016-01-08  2016-02-02  125000     16    911006     1501   \n",
       "2   GLIDER        3  2016-02-02  2016-04-20  125000     24    911008     1503   \n",
       "3   GLIDER        4  2016-04-20  2016-07-07  125000     24    911006     1501   \n",
       "4   GLIDER        5  2016-07-07  2016-08-16  125000     24    911008     1503   \n",
       "..     ...      ...         ...         ...     ...    ...       ...      ...   \n",
       "89  GLIDER  MC_C026  2023-06-22  2023-07-30  128000     24   G003654  AMAR-G4   \n",
       "90  GLIDER  ME_C012  2023-06-20  2023-08-01  128000     24   C000811  AMAR-G4   \n",
       "91  GLIDER  MC_C027  2023-12-30  2023-12-30  128000     24   G003654  AMAR-G4   \n",
       "92  GLIDER  MC_C028  2023-08-03  2023-09-09  128000     24   F001108  AMAR-G4   \n",
       "93  GLIDER  MC_C029  2023-09-24  2023-10-05  128000     24   I000091  AMAR-G4   \n",
       "\n",
       "       N/S  Ciclo_new  \n",
       "0    SG618          0  \n",
       "1    SG618          1  \n",
       "2    SG612          2  \n",
       "3    SG612          3  \n",
       "4    SG612          4  \n",
       "..     ...        ...  \n",
       "89   SL976         89  \n",
       "90   SL977         90  \n",
       "91   SL975         91  \n",
       "92   SL977         92  \n",
       "93  SL1099         93  \n",
       "\n",
       "[94 rows x 10 columns]"
      ]
     },
     "execution_count": 15,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "ciclos_dataframe_csv"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "0bccb0c9",
   "metadata": {},
   "source": [
    "# Extraindo informações do arquivo \".csv\" com as localizações (lat,lon,dep)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "id": "57d04cad",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>time</th>\n",
       "      <th>filename</th>\n",
       "      <th>latitude</th>\n",
       "      <th>longitude</th>\n",
       "      <th>depth</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>2015-11-12 13:48:40.999995</td>\n",
       "      <td>pa0001au_001_151112_134841_rms_spl3.mat</td>\n",
       "      <td>-23.825157</td>\n",
       "      <td>-42.495483</td>\n",
       "      <td>1.314286</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2015-11-12 13:49:41.000001</td>\n",
       "      <td>pa0001au_001_151112_134841_rms_spl3.mat</td>\n",
       "      <td>-23.824950</td>\n",
       "      <td>-42.495487</td>\n",
       "      <td>7.415555</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2015-11-12 13:50:40.999998</td>\n",
       "      <td>pa0001au_002_151112_135041_rms_spl3.mat</td>\n",
       "      <td>-23.824745</td>\n",
       "      <td>-42.495490</td>\n",
       "      <td>15.776000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>2015-11-12 13:51:41.000004</td>\n",
       "      <td>pa0001au_002_151112_135041_rms_spl3.mat</td>\n",
       "      <td>-23.824540</td>\n",
       "      <td>-42.495495</td>\n",
       "      <td>24.372000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>2015-11-12 13:52:41.000001</td>\n",
       "      <td>pa0001au_003_151112_135241_rms_spl3.mat</td>\n",
       "      <td>-23.824331</td>\n",
       "      <td>-42.495500</td>\n",
       "      <td>32.912000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>547748</th>\n",
       "      <td>2021-11-04 06:52:38.000000</td>\n",
       "      <td>pa0296au_011_211104_064338_rms_spl3.mat</td>\n",
       "      <td>-24.461742</td>\n",
       "      <td>-42.471264</td>\n",
       "      <td>866.012900</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>547749</th>\n",
       "      <td>2021-11-04 06:53:37.999997</td>\n",
       "      <td>pa0296au_012_211104_065338_rms_spl3.mat</td>\n",
       "      <td>-24.461819</td>\n",
       "      <td>-42.471302</td>\n",
       "      <td>873.586100</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>547750</th>\n",
       "      <td>2021-11-04 06:54:38.000003</td>\n",
       "      <td>pa0296au_012_211104_065338_rms_spl3.mat</td>\n",
       "      <td>-24.461980</td>\n",
       "      <td>-42.471510</td>\n",
       "      <td>879.579600</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>547751</th>\n",
       "      <td>2021-11-04 06:55:38.000000</td>\n",
       "      <td>pa0296au_012_211104_065338_rms_spl3.mat</td>\n",
       "      <td>-24.462152</td>\n",
       "      <td>-42.471740</td>\n",
       "      <td>884.380700</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>547752</th>\n",
       "      <td>2021-11-04 06:56:37.999996</td>\n",
       "      <td>pa0296au_012_211104_065338_rms_spl3.mat</td>\n",
       "      <td>-24.462324</td>\n",
       "      <td>-42.471966</td>\n",
       "      <td>888.467200</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>547753 rows × 5 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                             time                                 filename  \\\n",
       "0      2015-11-12 13:48:40.999995  pa0001au_001_151112_134841_rms_spl3.mat   \n",
       "1      2015-11-12 13:49:41.000001  pa0001au_001_151112_134841_rms_spl3.mat   \n",
       "2      2015-11-12 13:50:40.999998  pa0001au_002_151112_135041_rms_spl3.mat   \n",
       "3      2015-11-12 13:51:41.000004  pa0001au_002_151112_135041_rms_spl3.mat   \n",
       "4      2015-11-12 13:52:41.000001  pa0001au_003_151112_135241_rms_spl3.mat   \n",
       "...                           ...                                      ...   \n",
       "547748 2021-11-04 06:52:38.000000  pa0296au_011_211104_064338_rms_spl3.mat   \n",
       "547749 2021-11-04 06:53:37.999997  pa0296au_012_211104_065338_rms_spl3.mat   \n",
       "547750 2021-11-04 06:54:38.000003  pa0296au_012_211104_065338_rms_spl3.mat   \n",
       "547751 2021-11-04 06:55:38.000000  pa0296au_012_211104_065338_rms_spl3.mat   \n",
       "547752 2021-11-04 06:56:37.999996  pa0296au_012_211104_065338_rms_spl3.mat   \n",
       "\n",
       "         latitude  longitude       depth  \n",
       "0      -23.825157 -42.495483    1.314286  \n",
       "1      -23.824950 -42.495487    7.415555  \n",
       "2      -23.824745 -42.495490   15.776000  \n",
       "3      -23.824540 -42.495495   24.372000  \n",
       "4      -23.824331 -42.495500   32.912000  \n",
       "...           ...        ...         ...  \n",
       "547748 -24.461742 -42.471264  866.012900  \n",
       "547749 -24.461819 -42.471302  873.586100  \n",
       "547750 -24.461980 -42.471510  879.579600  \n",
       "547751 -24.462152 -42.471740  884.380700  \n",
       "547752 -24.462324 -42.471966  888.467200  \n",
       "\n",
       "[547753 rows x 5 columns]"
      ]
     },
     "execution_count": 16,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "dataframe_csv = pd.read_csv(filename_csv,parse_dates=['time'])\n",
    "dataframe_csv.sort_values(by='time')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "id": "bbd2e7e5",
   "metadata": {},
   "outputs": [],
   "source": [
    "df_csv = dataframe_csv.groupby(\"filename\").agg(pd.Series.tolist)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "id": "001eeaa8",
   "metadata": {},
   "outputs": [],
   "source": [
    "df_csv['filename_mseed'] = df_csv.index.str.replace('_rms_spl3.mat', '')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "id": "6ad5db63",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>time</th>\n",
       "      <th>latitude</th>\n",
       "      <th>longitude</th>\n",
       "      <th>depth</th>\n",
       "      <th>filename_mseed</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>filename</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>pa0001au_001_151112_134841_rms_spl3.mat</th>\n",
       "      <td>[2015-11-12 13:48:40.999995, 2015-11-12 13:49:...</td>\n",
       "      <td>[-23.825157, -23.82495]</td>\n",
       "      <td>[-42.495483, -42.495487]</td>\n",
       "      <td>[1.3142858, 7.4155555]</td>\n",
       "      <td>pa0001au_001_151112_134841</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>pa0001au_002_151112_135041_rms_spl3.mat</th>\n",
       "      <td>[2015-11-12 13:50:40.999998, 2015-11-12 13:51:...</td>\n",
       "      <td>[-23.824745, -23.82454]</td>\n",
       "      <td>[-42.49549, -42.495495]</td>\n",
       "      <td>[15.776, 24.372]</td>\n",
       "      <td>pa0001au_002_151112_135041</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>pa0001au_003_151112_135241_rms_spl3.mat</th>\n",
       "      <td>[2015-11-12 13:52:41.000001, 2015-11-12 13:53:...</td>\n",
       "      <td>[-23.824331, -23.824125]</td>\n",
       "      <td>[-42.4955, -42.495502]</td>\n",
       "      <td>[32.912, 41.34]</td>\n",
       "      <td>pa0001au_003_151112_135241</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>pa0001au_004_151112_135441_rms_spl3.mat</th>\n",
       "      <td>[2015-11-12 13:54:41.000004, 2015-11-12 13:55:41]</td>\n",
       "      <td>[-23.82392, -23.823713]</td>\n",
       "      <td>[-42.495506, -42.495506]</td>\n",
       "      <td>[48.91, 52.824]</td>\n",
       "      <td>pa0001au_004_151112_135441</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>pa0002au_001_151112_143618_rms_spl3.mat</th>\n",
       "      <td>[2015-11-12 14:36:17.999998, 2015-11-12 14:37:...</td>\n",
       "      <td>[-23.817575, -23.81744]</td>\n",
       "      <td>[-42.49506, -42.494965]</td>\n",
       "      <td>[1.4671428, 9.36]</td>\n",
       "      <td>pa0002au_001_151112_143618</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>pa0296au_008_211104_061338_rms_spl3.mat</th>\n",
       "      <td>[2021-11-04 06:13:37.999999, 2021-11-04 06:14:...</td>\n",
       "      <td>[-24.457632, -24.457657, -24.457726, -24.45786...</td>\n",
       "      <td>[-42.470257, -42.470303, -42.470325, -42.47033...</td>\n",
       "      <td>[550.4096, 559.3073, 567.8462, 575.10706, 582....</td>\n",
       "      <td>pa0296au_008_211104_061338</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>pa0296au_009_211104_062338_rms_spl3.mat</th>\n",
       "      <td>[2021-11-04 06:23:38.000003, 2021-11-04 06:24:...</td>\n",
       "      <td>[-24.458628, -24.458672, -24.45872, -24.458822...</td>\n",
       "      <td>[-42.47047, -42.470528, -42.470562, -42.470573...</td>\n",
       "      <td>[629.96436, 637.68353, 646.56323, 654.6224, 66...</td>\n",
       "      <td>pa0296au_009_211104_062338</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>pa0296au_010_211104_063338_rms_spl3.mat</th>\n",
       "      <td>[2021-11-04 06:33:37.999998, 2021-11-04 06:34:...</td>\n",
       "      <td>[-24.459415, -24.459513, -24.45957, -24.45963,...</td>\n",
       "      <td>[-42.4708, -42.470802, -42.470856, -42.4709, -...</td>\n",
       "      <td>[706.7263, 715.5506, 722.5956, 730.11316, 737....</td>\n",
       "      <td>pa0296au_010_211104_063338</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>pa0296au_011_211104_064338_rms_spl3.mat</th>\n",
       "      <td>[2021-11-04 06:43:38.000002, 2021-11-04 06:44:...</td>\n",
       "      <td>[-24.46027, -24.460333, -24.460466, -24.460562...</td>\n",
       "      <td>[-42.471066, -42.471092, -42.471092, -42.47112...</td>\n",
       "      <td>[786.4262, 795.43823, 804.53156, 811.73206, 82...</td>\n",
       "      <td>pa0296au_011_211104_064338</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>pa0296au_012_211104_065338_rms_spl3.mat</th>\n",
       "      <td>[2021-11-04 06:53:37.999997, 2021-11-04 06:54:...</td>\n",
       "      <td>[-24.461819, -24.46198, -24.462152, -24.462324]</td>\n",
       "      <td>[-42.471302, -42.47151, -42.47174, -42.471966]</td>\n",
       "      <td>[873.5861, 879.5796, 884.3807, 888.4672]</td>\n",
       "      <td>pa0296au_012_211104_065338</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>123321 rows × 5 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                                                                                      time  \\\n",
       "filename                                                                                     \n",
       "pa0001au_001_151112_134841_rms_spl3.mat  [2015-11-12 13:48:40.999995, 2015-11-12 13:49:...   \n",
       "pa0001au_002_151112_135041_rms_spl3.mat  [2015-11-12 13:50:40.999998, 2015-11-12 13:51:...   \n",
       "pa0001au_003_151112_135241_rms_spl3.mat  [2015-11-12 13:52:41.000001, 2015-11-12 13:53:...   \n",
       "pa0001au_004_151112_135441_rms_spl3.mat  [2015-11-12 13:54:41.000004, 2015-11-12 13:55:41]   \n",
       "pa0002au_001_151112_143618_rms_spl3.mat  [2015-11-12 14:36:17.999998, 2015-11-12 14:37:...   \n",
       "...                                                                                    ...   \n",
       "pa0296au_008_211104_061338_rms_spl3.mat  [2021-11-04 06:13:37.999999, 2021-11-04 06:14:...   \n",
       "pa0296au_009_211104_062338_rms_spl3.mat  [2021-11-04 06:23:38.000003, 2021-11-04 06:24:...   \n",
       "pa0296au_010_211104_063338_rms_spl3.mat  [2021-11-04 06:33:37.999998, 2021-11-04 06:34:...   \n",
       "pa0296au_011_211104_064338_rms_spl3.mat  [2021-11-04 06:43:38.000002, 2021-11-04 06:44:...   \n",
       "pa0296au_012_211104_065338_rms_spl3.mat  [2021-11-04 06:53:37.999997, 2021-11-04 06:54:...   \n",
       "\n",
       "                                                                                  latitude  \\\n",
       "filename                                                                                     \n",
       "pa0001au_001_151112_134841_rms_spl3.mat                            [-23.825157, -23.82495]   \n",
       "pa0001au_002_151112_135041_rms_spl3.mat                            [-23.824745, -23.82454]   \n",
       "pa0001au_003_151112_135241_rms_spl3.mat                           [-23.824331, -23.824125]   \n",
       "pa0001au_004_151112_135441_rms_spl3.mat                            [-23.82392, -23.823713]   \n",
       "pa0002au_001_151112_143618_rms_spl3.mat                            [-23.817575, -23.81744]   \n",
       "...                                                                                    ...   \n",
       "pa0296au_008_211104_061338_rms_spl3.mat  [-24.457632, -24.457657, -24.457726, -24.45786...   \n",
       "pa0296au_009_211104_062338_rms_spl3.mat  [-24.458628, -24.458672, -24.45872, -24.458822...   \n",
       "pa0296au_010_211104_063338_rms_spl3.mat  [-24.459415, -24.459513, -24.45957, -24.45963,...   \n",
       "pa0296au_011_211104_064338_rms_spl3.mat  [-24.46027, -24.460333, -24.460466, -24.460562...   \n",
       "pa0296au_012_211104_065338_rms_spl3.mat    [-24.461819, -24.46198, -24.462152, -24.462324]   \n",
       "\n",
       "                                                                                 longitude  \\\n",
       "filename                                                                                     \n",
       "pa0001au_001_151112_134841_rms_spl3.mat                           [-42.495483, -42.495487]   \n",
       "pa0001au_002_151112_135041_rms_spl3.mat                            [-42.49549, -42.495495]   \n",
       "pa0001au_003_151112_135241_rms_spl3.mat                             [-42.4955, -42.495502]   \n",
       "pa0001au_004_151112_135441_rms_spl3.mat                           [-42.495506, -42.495506]   \n",
       "pa0002au_001_151112_143618_rms_spl3.mat                            [-42.49506, -42.494965]   \n",
       "...                                                                                    ...   \n",
       "pa0296au_008_211104_061338_rms_spl3.mat  [-42.470257, -42.470303, -42.470325, -42.47033...   \n",
       "pa0296au_009_211104_062338_rms_spl3.mat  [-42.47047, -42.470528, -42.470562, -42.470573...   \n",
       "pa0296au_010_211104_063338_rms_spl3.mat  [-42.4708, -42.470802, -42.470856, -42.4709, -...   \n",
       "pa0296au_011_211104_064338_rms_spl3.mat  [-42.471066, -42.471092, -42.471092, -42.47112...   \n",
       "pa0296au_012_211104_065338_rms_spl3.mat     [-42.471302, -42.47151, -42.47174, -42.471966]   \n",
       "\n",
       "                                                                                     depth  \\\n",
       "filename                                                                                     \n",
       "pa0001au_001_151112_134841_rms_spl3.mat                             [1.3142858, 7.4155555]   \n",
       "pa0001au_002_151112_135041_rms_spl3.mat                                   [15.776, 24.372]   \n",
       "pa0001au_003_151112_135241_rms_spl3.mat                                    [32.912, 41.34]   \n",
       "pa0001au_004_151112_135441_rms_spl3.mat                                    [48.91, 52.824]   \n",
       "pa0002au_001_151112_143618_rms_spl3.mat                                  [1.4671428, 9.36]   \n",
       "...                                                                                    ...   \n",
       "pa0296au_008_211104_061338_rms_spl3.mat  [550.4096, 559.3073, 567.8462, 575.10706, 582....   \n",
       "pa0296au_009_211104_062338_rms_spl3.mat  [629.96436, 637.68353, 646.56323, 654.6224, 66...   \n",
       "pa0296au_010_211104_063338_rms_spl3.mat  [706.7263, 715.5506, 722.5956, 730.11316, 737....   \n",
       "pa0296au_011_211104_064338_rms_spl3.mat  [786.4262, 795.43823, 804.53156, 811.73206, 82...   \n",
       "pa0296au_012_211104_065338_rms_spl3.mat           [873.5861, 879.5796, 884.3807, 888.4672]   \n",
       "\n",
       "                                                     filename_mseed  \n",
       "filename                                                             \n",
       "pa0001au_001_151112_134841_rms_spl3.mat  pa0001au_001_151112_134841  \n",
       "pa0001au_002_151112_135041_rms_spl3.mat  pa0001au_002_151112_135041  \n",
       "pa0001au_003_151112_135241_rms_spl3.mat  pa0001au_003_151112_135241  \n",
       "pa0001au_004_151112_135441_rms_spl3.mat  pa0001au_004_151112_135441  \n",
       "pa0002au_001_151112_143618_rms_spl3.mat  pa0002au_001_151112_143618  \n",
       "...                                                             ...  \n",
       "pa0296au_008_211104_061338_rms_spl3.mat  pa0296au_008_211104_061338  \n",
       "pa0296au_009_211104_062338_rms_spl3.mat  pa0296au_009_211104_062338  \n",
       "pa0296au_010_211104_063338_rms_spl3.mat  pa0296au_010_211104_063338  \n",
       "pa0296au_011_211104_064338_rms_spl3.mat  pa0296au_011_211104_064338  \n",
       "pa0296au_012_211104_065338_rms_spl3.mat  pa0296au_012_211104_065338  \n",
       "\n",
       "[123321 rows x 5 columns]"
      ]
     },
     "execution_count": 19,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_csv.sort_values(by='time')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "id": "e3dc7b37",
   "metadata": {},
   "outputs": [],
   "source": [
    "def name_to_mergulho_stream(filename):\n",
    "    if 'pa' in filename.split('_')[0]:\n",
    "        mergulho = filename.split('_')[0].split('a')[1]\n",
    "\n",
    "    if 'pa' in filename.split('_')[2]:\n",
    "        mergulho = filename.split('_')[2].split('a')[1]\n",
    "    \n",
    "    return mergulho"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "id": "bde6d5c0",
   "metadata": {},
   "outputs": [],
   "source": [
    "def calcular_media(lista):\n",
    "    if len(lista) == 0:\n",
    "        return None  # Retorna None se a lista estiver vazia para evitar erros\n",
    "    else:\n",
    "        return pd.Series(lista).mean()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "id": "6ece4ec8",
   "metadata": {},
   "outputs": [],
   "source": [
    "def flatten(l):\n",
    "    return l[0]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "id": "f12c590e",
   "metadata": {},
   "outputs": [],
   "source": [
    "df_csv['mergulho'] = df_csv['filename_mseed'].apply(name_to_mergulho_stream)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "id": "9d18f096",
   "metadata": {},
   "outputs": [],
   "source": [
    "df_csv['date'] = df_csv['time'].apply(calcular_media).dt.date"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "id": "0c2eb186",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>time</th>\n",
       "      <th>latitude</th>\n",
       "      <th>longitude</th>\n",
       "      <th>depth</th>\n",
       "      <th>filename_mseed</th>\n",
       "      <th>mergulho</th>\n",
       "      <th>date</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>filename</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>160708_172008_pa0003au_001_rms_spl3.mat</th>\n",
       "      <td>[2016-07-08 17:20:07.999999, 2016-07-08 17:21:...</td>\n",
       "      <td>[-24.391026, -24.391314, -24.391335]</td>\n",
       "      <td>[-43.821663, -43.82173, -43.82174]</td>\n",
       "      <td>[0.9987981, 9.891874, 10.969999]</td>\n",
       "      <td>160708_172008_pa0003au_001</td>\n",
       "      <td>0003</td>\n",
       "      <td>2016-07-08</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>160708_172307_pa0003au_002_rms_spl3.mat</th>\n",
       "      <td>[2016-07-08 17:23:07.000004, 2016-07-08 17:24:...</td>\n",
       "      <td>[-24.391356, -24.3916, -24.391617]</td>\n",
       "      <td>[-43.821743, -43.8218, -43.821804]</td>\n",
       "      <td>[12.030156, 23.590548, 24.420235]</td>\n",
       "      <td>160708_172307_pa0003au_002</td>\n",
       "      <td>0003</td>\n",
       "      <td>2016-07-08</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>160708_172607_pa0003au_003_rms_spl3.mat</th>\n",
       "      <td>[2016-07-08 17:26:07.000003, 2016-07-08 17:27:...</td>\n",
       "      <td>[-24.391909, -24.39193, -24.392172]</td>\n",
       "      <td>[-43.821873, -43.82188, -43.821938]</td>\n",
       "      <td>[36.456642, 37.333202, 47.245785]</td>\n",
       "      <td>160708_172607_pa0003au_003</td>\n",
       "      <td>0003</td>\n",
       "      <td>2016-07-08</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>160708_172906_pa0003au_004_rms_spl3.mat</th>\n",
       "      <td>[2016-07-08 17:29:05.999998, 2016-07-08 17:30:...</td>\n",
       "      <td>[-24.392193, -24.392475, -24.392496]</td>\n",
       "      <td>[-43.82194, -43.822006, -43.82201]</td>\n",
       "      <td>[48.01094, 58.52969, 59.289062]</td>\n",
       "      <td>160708_172906_pa0003au_004</td>\n",
       "      <td>0003</td>\n",
       "      <td>2016-07-08</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>160708_173205_pa0003au_005_rms_spl3.mat</th>\n",
       "      <td>[2016-07-08 17:32:05.000003, 2016-07-08 17:33:...</td>\n",
       "      <td>[-24.392744, -24.392765, -24.393057]</td>\n",
       "      <td>[-43.822067, -43.822075, -43.822144]</td>\n",
       "      <td>[68.57156, 69.49031, 80.89149]</td>\n",
       "      <td>160708_173205_pa0003au_005</td>\n",
       "      <td>0003</td>\n",
       "      <td>2016-07-08</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>pa0626au_041_160418_075202_rms_spl3.mat</th>\n",
       "      <td>[2016-04-18 07:52:02.000001, 2016-04-18 07:53:...</td>\n",
       "      <td>[-24.46632, -24.466305]</td>\n",
       "      <td>[-43.148865, -43.14886]</td>\n",
       "      <td>[897.4117, 899.9383]</td>\n",
       "      <td>pa0626au_041_160418_075202</td>\n",
       "      <td>0626</td>\n",
       "      <td>2016-04-18</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>pa0626au_042_160418_075402_rms_spl3.mat</th>\n",
       "      <td>[2016-04-18 07:54:02.000004, 2016-04-18 07:55:02]</td>\n",
       "      <td>[-24.466183, -24.466167]</td>\n",
       "      <td>[-43.14885, -43.148846]</td>\n",
       "      <td>[918.85736, 921.4589]</td>\n",
       "      <td>pa0626au_042_160418_075402</td>\n",
       "      <td>0626</td>\n",
       "      <td>2016-04-18</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>pa0626au_043_160418_075602_rms_spl3.mat</th>\n",
       "      <td>[2016-04-18 07:56:01.999997, 2016-04-18 07:57:...</td>\n",
       "      <td>[-24.466047, -24.466032]</td>\n",
       "      <td>[-43.148834, -43.14883]</td>\n",
       "      <td>[940.0661, 942.0864]</td>\n",
       "      <td>pa0626au_043_160418_075602</td>\n",
       "      <td>0626</td>\n",
       "      <td>2016-04-18</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>pa0626au_044_160418_075802_rms_spl3.mat</th>\n",
       "      <td>[2016-04-18 07:58:02, 2016-04-18 07:59:01.999996]</td>\n",
       "      <td>[-24.465881, -24.465864]</td>\n",
       "      <td>[-43.148815, -43.14881]</td>\n",
       "      <td>[958.9343, 959.4406]</td>\n",
       "      <td>pa0626au_044_160418_075802</td>\n",
       "      <td>0626</td>\n",
       "      <td>2016-04-18</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>pa0626au_045_160418_080002_rms_spl3.mat</th>\n",
       "      <td>[2016-04-18 08:00:02.000003, 2016-04-18 08:01:...</td>\n",
       "      <td>[-24.465744, -24.465727]</td>\n",
       "      <td>[-43.1488, -43.1488]</td>\n",
       "      <td>[963.1847, 963.6253]</td>\n",
       "      <td>pa0626au_045_160418_080002</td>\n",
       "      <td>0626</td>\n",
       "      <td>2016-04-18</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>123321 rows × 7 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                                                                                      time  \\\n",
       "filename                                                                                     \n",
       "160708_172008_pa0003au_001_rms_spl3.mat  [2016-07-08 17:20:07.999999, 2016-07-08 17:21:...   \n",
       "160708_172307_pa0003au_002_rms_spl3.mat  [2016-07-08 17:23:07.000004, 2016-07-08 17:24:...   \n",
       "160708_172607_pa0003au_003_rms_spl3.mat  [2016-07-08 17:26:07.000003, 2016-07-08 17:27:...   \n",
       "160708_172906_pa0003au_004_rms_spl3.mat  [2016-07-08 17:29:05.999998, 2016-07-08 17:30:...   \n",
       "160708_173205_pa0003au_005_rms_spl3.mat  [2016-07-08 17:32:05.000003, 2016-07-08 17:33:...   \n",
       "...                                                                                    ...   \n",
       "pa0626au_041_160418_075202_rms_spl3.mat  [2016-04-18 07:52:02.000001, 2016-04-18 07:53:...   \n",
       "pa0626au_042_160418_075402_rms_spl3.mat  [2016-04-18 07:54:02.000004, 2016-04-18 07:55:02]   \n",
       "pa0626au_043_160418_075602_rms_spl3.mat  [2016-04-18 07:56:01.999997, 2016-04-18 07:57:...   \n",
       "pa0626au_044_160418_075802_rms_spl3.mat  [2016-04-18 07:58:02, 2016-04-18 07:59:01.999996]   \n",
       "pa0626au_045_160418_080002_rms_spl3.mat  [2016-04-18 08:00:02.000003, 2016-04-18 08:01:...   \n",
       "\n",
       "                                                                     latitude  \\\n",
       "filename                                                                        \n",
       "160708_172008_pa0003au_001_rms_spl3.mat  [-24.391026, -24.391314, -24.391335]   \n",
       "160708_172307_pa0003au_002_rms_spl3.mat    [-24.391356, -24.3916, -24.391617]   \n",
       "160708_172607_pa0003au_003_rms_spl3.mat   [-24.391909, -24.39193, -24.392172]   \n",
       "160708_172906_pa0003au_004_rms_spl3.mat  [-24.392193, -24.392475, -24.392496]   \n",
       "160708_173205_pa0003au_005_rms_spl3.mat  [-24.392744, -24.392765, -24.393057]   \n",
       "...                                                                       ...   \n",
       "pa0626au_041_160418_075202_rms_spl3.mat               [-24.46632, -24.466305]   \n",
       "pa0626au_042_160418_075402_rms_spl3.mat              [-24.466183, -24.466167]   \n",
       "pa0626au_043_160418_075602_rms_spl3.mat              [-24.466047, -24.466032]   \n",
       "pa0626au_044_160418_075802_rms_spl3.mat              [-24.465881, -24.465864]   \n",
       "pa0626au_045_160418_080002_rms_spl3.mat              [-24.465744, -24.465727]   \n",
       "\n",
       "                                                                    longitude  \\\n",
       "filename                                                                        \n",
       "160708_172008_pa0003au_001_rms_spl3.mat    [-43.821663, -43.82173, -43.82174]   \n",
       "160708_172307_pa0003au_002_rms_spl3.mat    [-43.821743, -43.8218, -43.821804]   \n",
       "160708_172607_pa0003au_003_rms_spl3.mat   [-43.821873, -43.82188, -43.821938]   \n",
       "160708_172906_pa0003au_004_rms_spl3.mat    [-43.82194, -43.822006, -43.82201]   \n",
       "160708_173205_pa0003au_005_rms_spl3.mat  [-43.822067, -43.822075, -43.822144]   \n",
       "...                                                                       ...   \n",
       "pa0626au_041_160418_075202_rms_spl3.mat               [-43.148865, -43.14886]   \n",
       "pa0626au_042_160418_075402_rms_spl3.mat               [-43.14885, -43.148846]   \n",
       "pa0626au_043_160418_075602_rms_spl3.mat               [-43.148834, -43.14883]   \n",
       "pa0626au_044_160418_075802_rms_spl3.mat               [-43.148815, -43.14881]   \n",
       "pa0626au_045_160418_080002_rms_spl3.mat                  [-43.1488, -43.1488]   \n",
       "\n",
       "                                                                     depth  \\\n",
       "filename                                                                     \n",
       "160708_172008_pa0003au_001_rms_spl3.mat   [0.9987981, 9.891874, 10.969999]   \n",
       "160708_172307_pa0003au_002_rms_spl3.mat  [12.030156, 23.590548, 24.420235]   \n",
       "160708_172607_pa0003au_003_rms_spl3.mat  [36.456642, 37.333202, 47.245785]   \n",
       "160708_172906_pa0003au_004_rms_spl3.mat    [48.01094, 58.52969, 59.289062]   \n",
       "160708_173205_pa0003au_005_rms_spl3.mat     [68.57156, 69.49031, 80.89149]   \n",
       "...                                                                    ...   \n",
       "pa0626au_041_160418_075202_rms_spl3.mat               [897.4117, 899.9383]   \n",
       "pa0626au_042_160418_075402_rms_spl3.mat              [918.85736, 921.4589]   \n",
       "pa0626au_043_160418_075602_rms_spl3.mat               [940.0661, 942.0864]   \n",
       "pa0626au_044_160418_075802_rms_spl3.mat               [958.9343, 959.4406]   \n",
       "pa0626au_045_160418_080002_rms_spl3.mat               [963.1847, 963.6253]   \n",
       "\n",
       "                                                     filename_mseed mergulho  \\\n",
       "filename                                                                       \n",
       "160708_172008_pa0003au_001_rms_spl3.mat  160708_172008_pa0003au_001     0003   \n",
       "160708_172307_pa0003au_002_rms_spl3.mat  160708_172307_pa0003au_002     0003   \n",
       "160708_172607_pa0003au_003_rms_spl3.mat  160708_172607_pa0003au_003     0003   \n",
       "160708_172906_pa0003au_004_rms_spl3.mat  160708_172906_pa0003au_004     0003   \n",
       "160708_173205_pa0003au_005_rms_spl3.mat  160708_173205_pa0003au_005     0003   \n",
       "...                                                             ...      ...   \n",
       "pa0626au_041_160418_075202_rms_spl3.mat  pa0626au_041_160418_075202     0626   \n",
       "pa0626au_042_160418_075402_rms_spl3.mat  pa0626au_042_160418_075402     0626   \n",
       "pa0626au_043_160418_075602_rms_spl3.mat  pa0626au_043_160418_075602     0626   \n",
       "pa0626au_044_160418_075802_rms_spl3.mat  pa0626au_044_160418_075802     0626   \n",
       "pa0626au_045_160418_080002_rms_spl3.mat  pa0626au_045_160418_080002     0626   \n",
       "\n",
       "                                               date  \n",
       "filename                                             \n",
       "160708_172008_pa0003au_001_rms_spl3.mat  2016-07-08  \n",
       "160708_172307_pa0003au_002_rms_spl3.mat  2016-07-08  \n",
       "160708_172607_pa0003au_003_rms_spl3.mat  2016-07-08  \n",
       "160708_172906_pa0003au_004_rms_spl3.mat  2016-07-08  \n",
       "160708_173205_pa0003au_005_rms_spl3.mat  2016-07-08  \n",
       "...                                             ...  \n",
       "pa0626au_041_160418_075202_rms_spl3.mat  2016-04-18  \n",
       "pa0626au_042_160418_075402_rms_spl3.mat  2016-04-18  \n",
       "pa0626au_043_160418_075602_rms_spl3.mat  2016-04-18  \n",
       "pa0626au_044_160418_075802_rms_spl3.mat  2016-04-18  \n",
       "pa0626au_045_160418_080002_rms_spl3.mat  2016-04-18  \n",
       "\n",
       "[123321 rows x 7 columns]"
      ]
     },
     "execution_count": 25,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_csv"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "id": "9f7033d3",
   "metadata": {},
   "outputs": [],
   "source": [
    "df_csv['lat'] =  df_csv['latitude'].apply(calcular_media)\n",
    "df_csv['lon'] =  df_csv['longitude'].apply(calcular_media)\n",
    "df_csv['dep'] =  df_csv['depth'].apply(calcular_media)\n",
    "df_csv['time'] =  df_csv['time'].apply(flatten)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 27,
   "id": "f19efdfa",
   "metadata": {},
   "outputs": [],
   "source": [
    "df_csv_mean = df_csv.drop(columns=['latitude','longitude','depth',])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "id": "d40a060f",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>time</th>\n",
       "      <th>filename_mseed</th>\n",
       "      <th>mergulho</th>\n",
       "      <th>date</th>\n",
       "      <th>lat</th>\n",
       "      <th>lon</th>\n",
       "      <th>dep</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>filename</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>pa0005au_015_151112_211136_rms_spl3.mat</th>\n",
       "      <td>2015-11-12 21:11:35.999997</td>\n",
       "      <td>pa0005au_015_151112_211136</td>\n",
       "      <td>0005</td>\n",
       "      <td>2015-11-12</td>\n",
       "      <td>-23.785293</td>\n",
       "      <td>-42.469156</td>\n",
       "      <td>258.771985</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>pa0004au_011_151112_180207_rms_spl3.mat</th>\n",
       "      <td>2015-11-12 18:02:06.999995</td>\n",
       "      <td>pa0004au_011_151112_180207</td>\n",
       "      <td>0004</td>\n",
       "      <td>2015-11-12</td>\n",
       "      <td>-23.791018</td>\n",
       "      <td>-42.473718</td>\n",
       "      <td>182.740000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>pa0004au_012_151112_180407_rms_spl3.mat</th>\n",
       "      <td>2015-11-12 18:04:06.999998</td>\n",
       "      <td>pa0004au_012_151112_180407</td>\n",
       "      <td>0004</td>\n",
       "      <td>2015-11-12</td>\n",
       "      <td>-23.791007</td>\n",
       "      <td>-42.473650</td>\n",
       "      <td>199.017500</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>pa0006au_001_151112_235913_rms_spl3.mat</th>\n",
       "      <td>2015-11-12 23:59:13.000003</td>\n",
       "      <td>pa0006au_001_151112_235913</td>\n",
       "      <td>0006</td>\n",
       "      <td>2015-11-12</td>\n",
       "      <td>-23.780344</td>\n",
       "      <td>-42.469132</td>\n",
       "      <td>8.517000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>pa0004au_013_151112_180607_rms_spl3.mat</th>\n",
       "      <td>2015-11-12 18:06:07.000001</td>\n",
       "      <td>pa0004au_013_151112_180607</td>\n",
       "      <td>0004</td>\n",
       "      <td>2015-11-12</td>\n",
       "      <td>-23.790993</td>\n",
       "      <td>-42.473582</td>\n",
       "      <td>215.688000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>pa0295au_010_211104_015556_rms_spl3.mat</th>\n",
       "      <td>2021-11-04 01:55:55.999999</td>\n",
       "      <td>pa0295au_010_211104_015556</td>\n",
       "      <td>0295</td>\n",
       "      <td>2021-11-04</td>\n",
       "      <td>-24.440742</td>\n",
       "      <td>-42.465287</td>\n",
       "      <td>736.252016</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>pa0296au_009_211104_062338_rms_spl3.mat</th>\n",
       "      <td>2021-11-04 06:23:38.000003</td>\n",
       "      <td>pa0296au_009_211104_062338</td>\n",
       "      <td>0296</td>\n",
       "      <td>2021-11-04</td>\n",
       "      <td>-24.458968</td>\n",
       "      <td>-42.470625</td>\n",
       "      <td>664.644524</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>pa0295au_009_211104_014556_rms_spl3.mat</th>\n",
       "      <td>2021-11-04 01:45:56.000005</td>\n",
       "      <td>pa0295au_009_211104_014556</td>\n",
       "      <td>0295</td>\n",
       "      <td>2021-11-04</td>\n",
       "      <td>-24.439859</td>\n",
       "      <td>-42.465195</td>\n",
       "      <td>652.485512</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>pa0295au_001_211104_002556_rms_spl3.mat</th>\n",
       "      <td>2021-11-04 00:25:55.999999</td>\n",
       "      <td>pa0295au_001_211104_002556</td>\n",
       "      <td>0295</td>\n",
       "      <td>2021-11-04</td>\n",
       "      <td>-24.433078</td>\n",
       "      <td>-42.464303</td>\n",
       "      <td>37.546308</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>pa0295au_012_211104_021556_rms_spl3.mat</th>\n",
       "      <td>2021-11-04 02:15:55.999998</td>\n",
       "      <td>pa0295au_012_211104_021556</td>\n",
       "      <td>0295</td>\n",
       "      <td>2021-11-04</td>\n",
       "      <td>-24.443011</td>\n",
       "      <td>-42.465975</td>\n",
       "      <td>869.489497</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>123321 rows × 7 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                                                              time  \\\n",
       "filename                                                             \n",
       "pa0005au_015_151112_211136_rms_spl3.mat 2015-11-12 21:11:35.999997   \n",
       "pa0004au_011_151112_180207_rms_spl3.mat 2015-11-12 18:02:06.999995   \n",
       "pa0004au_012_151112_180407_rms_spl3.mat 2015-11-12 18:04:06.999998   \n",
       "pa0006au_001_151112_235913_rms_spl3.mat 2015-11-12 23:59:13.000003   \n",
       "pa0004au_013_151112_180607_rms_spl3.mat 2015-11-12 18:06:07.000001   \n",
       "...                                                            ...   \n",
       "pa0295au_010_211104_015556_rms_spl3.mat 2021-11-04 01:55:55.999999   \n",
       "pa0296au_009_211104_062338_rms_spl3.mat 2021-11-04 06:23:38.000003   \n",
       "pa0295au_009_211104_014556_rms_spl3.mat 2021-11-04 01:45:56.000005   \n",
       "pa0295au_001_211104_002556_rms_spl3.mat 2021-11-04 00:25:55.999999   \n",
       "pa0295au_012_211104_021556_rms_spl3.mat 2021-11-04 02:15:55.999998   \n",
       "\n",
       "                                                     filename_mseed mergulho  \\\n",
       "filename                                                                       \n",
       "pa0005au_015_151112_211136_rms_spl3.mat  pa0005au_015_151112_211136     0005   \n",
       "pa0004au_011_151112_180207_rms_spl3.mat  pa0004au_011_151112_180207     0004   \n",
       "pa0004au_012_151112_180407_rms_spl3.mat  pa0004au_012_151112_180407     0004   \n",
       "pa0006au_001_151112_235913_rms_spl3.mat  pa0006au_001_151112_235913     0006   \n",
       "pa0004au_013_151112_180607_rms_spl3.mat  pa0004au_013_151112_180607     0004   \n",
       "...                                                             ...      ...   \n",
       "pa0295au_010_211104_015556_rms_spl3.mat  pa0295au_010_211104_015556     0295   \n",
       "pa0296au_009_211104_062338_rms_spl3.mat  pa0296au_009_211104_062338     0296   \n",
       "pa0295au_009_211104_014556_rms_spl3.mat  pa0295au_009_211104_014556     0295   \n",
       "pa0295au_001_211104_002556_rms_spl3.mat  pa0295au_001_211104_002556     0295   \n",
       "pa0295au_012_211104_021556_rms_spl3.mat  pa0295au_012_211104_021556     0295   \n",
       "\n",
       "                                               date        lat        lon  \\\n",
       "filename                                                                    \n",
       "pa0005au_015_151112_211136_rms_spl3.mat  2015-11-12 -23.785293 -42.469156   \n",
       "pa0004au_011_151112_180207_rms_spl3.mat  2015-11-12 -23.791018 -42.473718   \n",
       "pa0004au_012_151112_180407_rms_spl3.mat  2015-11-12 -23.791007 -42.473650   \n",
       "pa0006au_001_151112_235913_rms_spl3.mat  2015-11-12 -23.780344 -42.469132   \n",
       "pa0004au_013_151112_180607_rms_spl3.mat  2015-11-12 -23.790993 -42.473582   \n",
       "...                                             ...        ...        ...   \n",
       "pa0295au_010_211104_015556_rms_spl3.mat  2021-11-04 -24.440742 -42.465287   \n",
       "pa0296au_009_211104_062338_rms_spl3.mat  2021-11-04 -24.458968 -42.470625   \n",
       "pa0295au_009_211104_014556_rms_spl3.mat  2021-11-04 -24.439859 -42.465195   \n",
       "pa0295au_001_211104_002556_rms_spl3.mat  2021-11-04 -24.433078 -42.464303   \n",
       "pa0295au_012_211104_021556_rms_spl3.mat  2021-11-04 -24.443011 -42.465975   \n",
       "\n",
       "                                                dep  \n",
       "filename                                             \n",
       "pa0005au_015_151112_211136_rms_spl3.mat  258.771985  \n",
       "pa0004au_011_151112_180207_rms_spl3.mat  182.740000  \n",
       "pa0004au_012_151112_180407_rms_spl3.mat  199.017500  \n",
       "pa0006au_001_151112_235913_rms_spl3.mat    8.517000  \n",
       "pa0004au_013_151112_180607_rms_spl3.mat  215.688000  \n",
       "...                                             ...  \n",
       "pa0295au_010_211104_015556_rms_spl3.mat  736.252016  \n",
       "pa0296au_009_211104_062338_rms_spl3.mat  664.644524  \n",
       "pa0295au_009_211104_014556_rms_spl3.mat  652.485512  \n",
       "pa0295au_001_211104_002556_rms_spl3.mat   37.546308  \n",
       "pa0295au_012_211104_021556_rms_spl3.mat  869.489497  \n",
       "\n",
       "[123321 rows x 7 columns]"
      ]
     },
     "execution_count": 28,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_csv_mean.sort_values(by='date')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 29,
   "id": "4c5b5af1-7c73-470e-a739-4ff3cad3424c",
   "metadata": {},
   "outputs": [],
   "source": [
    "df_csv_meanS = df_csv_mean.sort_values(by='time')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 30,
   "id": "07c71965-287c-41e2-b8cd-981e6851d7b5",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "-936"
      ]
     },
     "execution_count": 30,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "len(sorted(df_csv_mean['filename_mseed'].to_list())) - len(sorted(dataframe_mseed_final['filename_mseed'].to_list()))"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "8774b2c5-63b6-4ad2-a87a-2e38219120c1",
   "metadata": {},
   "source": [
    "# Buscando o nome dos gliders no dataframe das campanhas:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 31,
   "id": "8d8256f1-cff2-4ded-97e7-af73e99d77f2",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Sistema</th>\n",
       "      <th>Ciclo</th>\n",
       "      <th>starttime</th>\n",
       "      <th>endtime</th>\n",
       "      <th>Fs</th>\n",
       "      <th>nBits</th>\n",
       "      <th>Hidrofone</th>\n",
       "      <th>PreAmp</th>\n",
       "      <th>N/S</th>\n",
       "      <th>Ciclo_new</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>GLIDER</td>\n",
       "      <td>1</td>\n",
       "      <td>2015-11-10</td>\n",
       "      <td>2015-12-20</td>\n",
       "      <td>125000</td>\n",
       "      <td>16</td>\n",
       "      <td>911006</td>\n",
       "      <td>1501</td>\n",
       "      <td>SG618</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>GLIDER</td>\n",
       "      <td>2</td>\n",
       "      <td>2016-01-08</td>\n",
       "      <td>2016-02-02</td>\n",
       "      <td>125000</td>\n",
       "      <td>16</td>\n",
       "      <td>911006</td>\n",
       "      <td>1501</td>\n",
       "      <td>SG618</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>GLIDER</td>\n",
       "      <td>3</td>\n",
       "      <td>2016-02-02</td>\n",
       "      <td>2016-04-20</td>\n",
       "      <td>125000</td>\n",
       "      <td>24</td>\n",
       "      <td>911008</td>\n",
       "      <td>1503</td>\n",
       "      <td>SG612</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>GLIDER</td>\n",
       "      <td>4</td>\n",
       "      <td>2016-04-20</td>\n",
       "      <td>2016-07-07</td>\n",
       "      <td>125000</td>\n",
       "      <td>24</td>\n",
       "      <td>911006</td>\n",
       "      <td>1501</td>\n",
       "      <td>SG612</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>GLIDER</td>\n",
       "      <td>5</td>\n",
       "      <td>2016-07-07</td>\n",
       "      <td>2016-08-16</td>\n",
       "      <td>125000</td>\n",
       "      <td>24</td>\n",
       "      <td>911008</td>\n",
       "      <td>1503</td>\n",
       "      <td>SG612</td>\n",
       "      <td>4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>89</th>\n",
       "      <td>GLIDER</td>\n",
       "      <td>MC_C026</td>\n",
       "      <td>2023-06-22</td>\n",
       "      <td>2023-07-30</td>\n",
       "      <td>128000</td>\n",
       "      <td>24</td>\n",
       "      <td>G003654</td>\n",
       "      <td>AMAR-G4</td>\n",
       "      <td>SL976</td>\n",
       "      <td>89</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>90</th>\n",
       "      <td>GLIDER</td>\n",
       "      <td>ME_C012</td>\n",
       "      <td>2023-06-20</td>\n",
       "      <td>2023-08-01</td>\n",
       "      <td>128000</td>\n",
       "      <td>24</td>\n",
       "      <td>C000811</td>\n",
       "      <td>AMAR-G4</td>\n",
       "      <td>SL977</td>\n",
       "      <td>90</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>91</th>\n",
       "      <td>GLIDER</td>\n",
       "      <td>MC_C027</td>\n",
       "      <td>2023-12-30</td>\n",
       "      <td>2023-12-30</td>\n",
       "      <td>128000</td>\n",
       "      <td>24</td>\n",
       "      <td>G003654</td>\n",
       "      <td>AMAR-G4</td>\n",
       "      <td>SL975</td>\n",
       "      <td>91</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>92</th>\n",
       "      <td>GLIDER</td>\n",
       "      <td>MC_C028</td>\n",
       "      <td>2023-08-03</td>\n",
       "      <td>2023-09-09</td>\n",
       "      <td>128000</td>\n",
       "      <td>24</td>\n",
       "      <td>F001108</td>\n",
       "      <td>AMAR-G4</td>\n",
       "      <td>SL977</td>\n",
       "      <td>92</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>93</th>\n",
       "      <td>GLIDER</td>\n",
       "      <td>MC_C029</td>\n",
       "      <td>2023-09-24</td>\n",
       "      <td>2023-10-05</td>\n",
       "      <td>128000</td>\n",
       "      <td>24</td>\n",
       "      <td>I000091</td>\n",
       "      <td>AMAR-G4</td>\n",
       "      <td>SL1099</td>\n",
       "      <td>93</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>94 rows × 10 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "   Sistema    Ciclo   starttime     endtime      Fs  nBits Hidrofone   PreAmp  \\\n",
       "0   GLIDER        1  2015-11-10  2015-12-20  125000     16    911006     1501   \n",
       "1   GLIDER        2  2016-01-08  2016-02-02  125000     16    911006     1501   \n",
       "2   GLIDER        3  2016-02-02  2016-04-20  125000     24    911008     1503   \n",
       "3   GLIDER        4  2016-04-20  2016-07-07  125000     24    911006     1501   \n",
       "4   GLIDER        5  2016-07-07  2016-08-16  125000     24    911008     1503   \n",
       "..     ...      ...         ...         ...     ...    ...       ...      ...   \n",
       "89  GLIDER  MC_C026  2023-06-22  2023-07-30  128000     24   G003654  AMAR-G4   \n",
       "90  GLIDER  ME_C012  2023-06-20  2023-08-01  128000     24   C000811  AMAR-G4   \n",
       "91  GLIDER  MC_C027  2023-12-30  2023-12-30  128000     24   G003654  AMAR-G4   \n",
       "92  GLIDER  MC_C028  2023-08-03  2023-09-09  128000     24   F001108  AMAR-G4   \n",
       "93  GLIDER  MC_C029  2023-09-24  2023-10-05  128000     24   I000091  AMAR-G4   \n",
       "\n",
       "       N/S  Ciclo_new  \n",
       "0    SG618          0  \n",
       "1    SG618          1  \n",
       "2    SG612          2  \n",
       "3    SG612          3  \n",
       "4    SG612          4  \n",
       "..     ...        ...  \n",
       "89   SL976         89  \n",
       "90   SL977         90  \n",
       "91   SL975         91  \n",
       "92   SL977         92  \n",
       "93  SL1099         93  \n",
       "\n",
       "[94 rows x 10 columns]"
      ]
     },
     "execution_count": 31,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "ciclos_dataframe_csv"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 32,
   "id": "9d19c3ae-79f3-44ba-8494-e14f430dd831",
   "metadata": {},
   "outputs": [],
   "source": [
    "def nearest(items, pivot):\n",
    "    return min(items, key=lambda x: abs(x - pivot))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 33,
   "id": "0dfd37d5-eda5-46ad-bc80-223e14c7c27e",
   "metadata": {},
   "outputs": [],
   "source": [
    "def convert_36(line):\n",
    "    '''\n",
    "    Creating the station name according to the hexatrigesimal two-digit algoritm conversion\n",
    "    '''\n",
    "    cycle_lst = [i for i in range(500)]\n",
    "    \n",
    "    # hexatrigesimal two digit number for each cycle:\n",
    "    hexatri_lst = [str(np.base_repr(y, 36)).zfill(2) for y in cycle_lst]\n",
    "    \n",
    "    #find the nearest date and append the 2-hexatrigesimal-digit:\n",
    "    return 'G'+line['starttime'].strftime('%y')+hexatri_lst[cycle_lst.index(nearest(cycle_lst,line['Ciclo_new']))]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 34,
   "id": "62bbb3d3-e093-4889-88fa-3d72bbdf5252",
   "metadata": {},
   "outputs": [],
   "source": [
    "ciclos_dataframe_csvS = ciclos_dataframe_csv.sort_values(by='starttime')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 35,
   "id": "4d2b6d9e-bb97-44a3-910b-ea9531426c85",
   "metadata": {},
   "outputs": [],
   "source": [
    "ciclos_dataframe_csvS['station_nettab'] = ciclos_dataframe_csvS.apply(convert_36,axis=1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 36,
   "id": "89d47fa5-165d-4136-894d-3dc719be3ad4",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Sistema</th>\n",
       "      <th>Ciclo</th>\n",
       "      <th>starttime</th>\n",
       "      <th>endtime</th>\n",
       "      <th>Fs</th>\n",
       "      <th>nBits</th>\n",
       "      <th>Hidrofone</th>\n",
       "      <th>PreAmp</th>\n",
       "      <th>N/S</th>\n",
       "      <th>Ciclo_new</th>\n",
       "      <th>station_nettab</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>GLIDER</td>\n",
       "      <td>1</td>\n",
       "      <td>2015-11-10</td>\n",
       "      <td>2015-12-20</td>\n",
       "      <td>125000</td>\n",
       "      <td>16</td>\n",
       "      <td>911006</td>\n",
       "      <td>1501</td>\n",
       "      <td>SG618</td>\n",
       "      <td>0</td>\n",
       "      <td>G1500</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>GLIDER</td>\n",
       "      <td>2</td>\n",
       "      <td>2016-01-08</td>\n",
       "      <td>2016-02-02</td>\n",
       "      <td>125000</td>\n",
       "      <td>16</td>\n",
       "      <td>911006</td>\n",
       "      <td>1501</td>\n",
       "      <td>SG618</td>\n",
       "      <td>1</td>\n",
       "      <td>G1601</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>GLIDER</td>\n",
       "      <td>3</td>\n",
       "      <td>2016-02-02</td>\n",
       "      <td>2016-04-20</td>\n",
       "      <td>125000</td>\n",
       "      <td>24</td>\n",
       "      <td>911008</td>\n",
       "      <td>1503</td>\n",
       "      <td>SG612</td>\n",
       "      <td>2</td>\n",
       "      <td>G1602</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>GLIDER</td>\n",
       "      <td>4</td>\n",
       "      <td>2016-04-20</td>\n",
       "      <td>2016-07-07</td>\n",
       "      <td>125000</td>\n",
       "      <td>24</td>\n",
       "      <td>911006</td>\n",
       "      <td>1501</td>\n",
       "      <td>SG612</td>\n",
       "      <td>3</td>\n",
       "      <td>G1603</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>GLIDER</td>\n",
       "      <td>5</td>\n",
       "      <td>2016-07-07</td>\n",
       "      <td>2016-08-16</td>\n",
       "      <td>125000</td>\n",
       "      <td>24</td>\n",
       "      <td>911008</td>\n",
       "      <td>1503</td>\n",
       "      <td>SG612</td>\n",
       "      <td>4</td>\n",
       "      <td>G1604</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>88</th>\n",
       "      <td>GLIDER</td>\n",
       "      <td>MC_C025</td>\n",
       "      <td>2023-06-21</td>\n",
       "      <td>2023-07-29</td>\n",
       "      <td>128000</td>\n",
       "      <td>24</td>\n",
       "      <td>F001108</td>\n",
       "      <td>AMAR-G4</td>\n",
       "      <td>SL975</td>\n",
       "      <td>88</td>\n",
       "      <td>G232G</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>89</th>\n",
       "      <td>GLIDER</td>\n",
       "      <td>MC_C026</td>\n",
       "      <td>2023-06-22</td>\n",
       "      <td>2023-07-30</td>\n",
       "      <td>128000</td>\n",
       "      <td>24</td>\n",
       "      <td>G003654</td>\n",
       "      <td>AMAR-G4</td>\n",
       "      <td>SL976</td>\n",
       "      <td>89</td>\n",
       "      <td>G232H</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>92</th>\n",
       "      <td>GLIDER</td>\n",
       "      <td>MC_C028</td>\n",
       "      <td>2023-08-03</td>\n",
       "      <td>2023-09-09</td>\n",
       "      <td>128000</td>\n",
       "      <td>24</td>\n",
       "      <td>F001108</td>\n",
       "      <td>AMAR-G4</td>\n",
       "      <td>SL977</td>\n",
       "      <td>92</td>\n",
       "      <td>G232K</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>93</th>\n",
       "      <td>GLIDER</td>\n",
       "      <td>MC_C029</td>\n",
       "      <td>2023-09-24</td>\n",
       "      <td>2023-10-05</td>\n",
       "      <td>128000</td>\n",
       "      <td>24</td>\n",
       "      <td>I000091</td>\n",
       "      <td>AMAR-G4</td>\n",
       "      <td>SL1099</td>\n",
       "      <td>93</td>\n",
       "      <td>G232L</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>91</th>\n",
       "      <td>GLIDER</td>\n",
       "      <td>MC_C027</td>\n",
       "      <td>2023-12-30</td>\n",
       "      <td>2023-12-30</td>\n",
       "      <td>128000</td>\n",
       "      <td>24</td>\n",
       "      <td>G003654</td>\n",
       "      <td>AMAR-G4</td>\n",
       "      <td>SL975</td>\n",
       "      <td>91</td>\n",
       "      <td>G232J</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>94 rows × 11 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "   Sistema    Ciclo   starttime     endtime      Fs  nBits Hidrofone   PreAmp  \\\n",
       "0   GLIDER        1  2015-11-10  2015-12-20  125000     16    911006     1501   \n",
       "1   GLIDER        2  2016-01-08  2016-02-02  125000     16    911006     1501   \n",
       "2   GLIDER        3  2016-02-02  2016-04-20  125000     24    911008     1503   \n",
       "3   GLIDER        4  2016-04-20  2016-07-07  125000     24    911006     1501   \n",
       "4   GLIDER        5  2016-07-07  2016-08-16  125000     24    911008     1503   \n",
       "..     ...      ...         ...         ...     ...    ...       ...      ...   \n",
       "88  GLIDER  MC_C025  2023-06-21  2023-07-29  128000     24   F001108  AMAR-G4   \n",
       "89  GLIDER  MC_C026  2023-06-22  2023-07-30  128000     24   G003654  AMAR-G4   \n",
       "92  GLIDER  MC_C028  2023-08-03  2023-09-09  128000     24   F001108  AMAR-G4   \n",
       "93  GLIDER  MC_C029  2023-09-24  2023-10-05  128000     24   I000091  AMAR-G4   \n",
       "91  GLIDER  MC_C027  2023-12-30  2023-12-30  128000     24   G003654  AMAR-G4   \n",
       "\n",
       "       N/S  Ciclo_new station_nettab  \n",
       "0    SG618          0          G1500  \n",
       "1    SG618          1          G1601  \n",
       "2    SG612          2          G1602  \n",
       "3    SG612          3          G1603  \n",
       "4    SG612          4          G1604  \n",
       "..     ...        ...            ...  \n",
       "88   SL975         88          G232G  \n",
       "89   SL976         89          G232H  \n",
       "92   SL977         92          G232K  \n",
       "93  SL1099         93          G232L  \n",
       "91   SL975         91          G232J  \n",
       "\n",
       "[94 rows x 11 columns]"
      ]
     },
     "execution_count": 36,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "ciclos_dataframe_csvS"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 37,
   "id": "121eece8-df08-43f0-9e94-f566a26e7f38",
   "metadata": {},
   "outputs": [],
   "source": [
    "def nettab_name_csv(line):\n",
    "    '''\n",
    "    Getting the station name code from other dataframe\n",
    "    '''\n",
    "    \n",
    "    filtro = (line.date >= ciclos_dataframe_csvS[\"starttime\"]) & (line.date <= ciclos_dataframe_csvS[\"endtime\"])\n",
    "    \n",
    "    df2 = ciclos_dataframe_csvS[filtro]\n",
    "\n",
    "    if len(df2) > 0:\n",
    "        return df2['station_nettab'].values[0],df2['N/S'].values[0],df2['Fs'].values[0],df2['nBits'].values[0],df2['Hidrofone'].values[0],df2['PreAmp'].values[0],df2['Ciclo_new'].values[0]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 38,
   "id": "4c44a961-c8d4-481c-9fa6-85341ffdd431",
   "metadata": {},
   "outputs": [],
   "source": [
    "df_csv_meanS_rows = [row for idx,row in df_csv_meanS.iterrows()]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 39,
   "id": "7cf98df7-e18a-4dd7-a305-42ecec71966d",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████| 123321/123321 [00:38<00:00, 3208.14it/s]\n"
     ]
    }
   ],
   "source": [
    "DF_PACK = []\n",
    "with Pool(processes=4) as p:\n",
    "    max_ = len(df_csv_meanS_rows)\n",
    "    with tqdm(total=max_) as pbar:\n",
    "        for result in p.imap_unordered(nettab_name_csv,df_csv_meanS_rows):\n",
    "            pbar.update()\n",
    "            if result is not None:\n",
    "                DF_PACK.append(result)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 40,
   "id": "9ba9926b-14ba-4c56-8b88-6921909be14c",
   "metadata": {},
   "outputs": [],
   "source": [
    "df_csv_meanS['station_nettab'] = [i[0] for i in DF_PACK]\n",
    "df_csv_meanS['N/S'] = [i[1] for i in DF_PACK]\n",
    "df_csv_meanS['Fs'] = [i[2] for i in DF_PACK]\n",
    "df_csv_meanS['nBits'] = [i[3] for i in DF_PACK]\n",
    "df_csv_meanS['Hidrofone'] = [i[4] for i in DF_PACK]\n",
    "df_csv_meanS['PreAmp'] = [i[5] for i in DF_PACK]\n",
    "df_csv_meanS['Ciclo'] = [i[6] for i in DF_PACK]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 41,
   "id": "6eb422f2-0250-4631-9847-a78baa7313d6",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>time</th>\n",
       "      <th>filename_mseed</th>\n",
       "      <th>mergulho</th>\n",
       "      <th>date</th>\n",
       "      <th>lat</th>\n",
       "      <th>lon</th>\n",
       "      <th>dep</th>\n",
       "      <th>station_nettab</th>\n",
       "      <th>N/S</th>\n",
       "      <th>Fs</th>\n",
       "      <th>nBits</th>\n",
       "      <th>Hidrofone</th>\n",
       "      <th>PreAmp</th>\n",
       "      <th>Ciclo</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>filename</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>pa0001au_001_151112_134841_rms_spl3.mat</th>\n",
       "      <td>2015-11-12 13:48:40.999995</td>\n",
       "      <td>pa0001au_001_151112_134841</td>\n",
       "      <td>0001</td>\n",
       "      <td>2015-11-12</td>\n",
       "      <td>-23.825054</td>\n",
       "      <td>-42.495485</td>\n",
       "      <td>4.364921</td>\n",
       "      <td>G1500</td>\n",
       "      <td>SG618</td>\n",
       "      <td>125000</td>\n",
       "      <td>16</td>\n",
       "      <td>911006</td>\n",
       "      <td>1501</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>pa0001au_002_151112_135041_rms_spl3.mat</th>\n",
       "      <td>2015-11-12 13:50:40.999998</td>\n",
       "      <td>pa0001au_002_151112_135041</td>\n",
       "      <td>0001</td>\n",
       "      <td>2015-11-12</td>\n",
       "      <td>-23.824642</td>\n",
       "      <td>-42.495492</td>\n",
       "      <td>20.074000</td>\n",
       "      <td>G1500</td>\n",
       "      <td>SG618</td>\n",
       "      <td>125000</td>\n",
       "      <td>16</td>\n",
       "      <td>911006</td>\n",
       "      <td>1501</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>pa0001au_003_151112_135241_rms_spl3.mat</th>\n",
       "      <td>2015-11-12 13:52:41.000001</td>\n",
       "      <td>pa0001au_003_151112_135241</td>\n",
       "      <td>0001</td>\n",
       "      <td>2015-11-12</td>\n",
       "      <td>-23.824228</td>\n",
       "      <td>-42.495501</td>\n",
       "      <td>37.126000</td>\n",
       "      <td>G1500</td>\n",
       "      <td>SG618</td>\n",
       "      <td>125000</td>\n",
       "      <td>16</td>\n",
       "      <td>911006</td>\n",
       "      <td>1501</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>pa0001au_004_151112_135441_rms_spl3.mat</th>\n",
       "      <td>2015-11-12 13:54:41.000004</td>\n",
       "      <td>pa0001au_004_151112_135441</td>\n",
       "      <td>0001</td>\n",
       "      <td>2015-11-12</td>\n",
       "      <td>-23.823816</td>\n",
       "      <td>-42.495506</td>\n",
       "      <td>50.867000</td>\n",
       "      <td>G1500</td>\n",
       "      <td>SG618</td>\n",
       "      <td>125000</td>\n",
       "      <td>16</td>\n",
       "      <td>911006</td>\n",
       "      <td>1501</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>pa0002au_001_151112_143618_rms_spl3.mat</th>\n",
       "      <td>2015-11-12 14:36:17.999998</td>\n",
       "      <td>pa0002au_001_151112_143618</td>\n",
       "      <td>0002</td>\n",
       "      <td>2015-11-12</td>\n",
       "      <td>-23.817508</td>\n",
       "      <td>-42.495013</td>\n",
       "      <td>5.413571</td>\n",
       "      <td>G1500</td>\n",
       "      <td>SG618</td>\n",
       "      <td>125000</td>\n",
       "      <td>16</td>\n",
       "      <td>911006</td>\n",
       "      <td>1501</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>pa0296au_008_211104_061338_rms_spl3.mat</th>\n",
       "      <td>2021-11-04 06:13:37.999999</td>\n",
       "      <td>pa0296au_008_211104_061338</td>\n",
       "      <td>0296</td>\n",
       "      <td>2021-11-04</td>\n",
       "      <td>-24.458063</td>\n",
       "      <td>-42.470370</td>\n",
       "      <td>586.134284</td>\n",
       "      <td>G211E</td>\n",
       "      <td>SG656</td>\n",
       "      <td>128000</td>\n",
       "      <td>24</td>\n",
       "      <td>D000342</td>\n",
       "      <td>AMAR-G4</td>\n",
       "      <td>50</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>pa0296au_009_211104_062338_rms_spl3.mat</th>\n",
       "      <td>2021-11-04 06:23:38.000003</td>\n",
       "      <td>pa0296au_009_211104_062338</td>\n",
       "      <td>0296</td>\n",
       "      <td>2021-11-04</td>\n",
       "      <td>-24.458968</td>\n",
       "      <td>-42.470625</td>\n",
       "      <td>664.644524</td>\n",
       "      <td>G211E</td>\n",
       "      <td>SG656</td>\n",
       "      <td>128000</td>\n",
       "      <td>24</td>\n",
       "      <td>D000342</td>\n",
       "      <td>AMAR-G4</td>\n",
       "      <td>50</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>pa0296au_010_211104_063338_rms_spl3.mat</th>\n",
       "      <td>2021-11-04 06:33:37.999998</td>\n",
       "      <td>pa0296au_010_211104_063338</td>\n",
       "      <td>0296</td>\n",
       "      <td>2021-11-04</td>\n",
       "      <td>-24.459786</td>\n",
       "      <td>-42.470928</td>\n",
       "      <td>741.901279</td>\n",
       "      <td>G211E</td>\n",
       "      <td>SG656</td>\n",
       "      <td>128000</td>\n",
       "      <td>24</td>\n",
       "      <td>D000342</td>\n",
       "      <td>AMAR-G4</td>\n",
       "      <td>50</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>pa0296au_011_211104_064338_rms_spl3.mat</th>\n",
       "      <td>2021-11-04 06:43:38.000002</td>\n",
       "      <td>pa0296au_011_211104_064338</td>\n",
       "      <td>0296</td>\n",
       "      <td>2021-11-04</td>\n",
       "      <td>-24.460836</td>\n",
       "      <td>-42.471147</td>\n",
       "      <td>826.451882</td>\n",
       "      <td>G211E</td>\n",
       "      <td>SG656</td>\n",
       "      <td>128000</td>\n",
       "      <td>24</td>\n",
       "      <td>D000342</td>\n",
       "      <td>AMAR-G4</td>\n",
       "      <td>50</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>pa0296au_012_211104_065338_rms_spl3.mat</th>\n",
       "      <td>2021-11-04 06:53:37.999997</td>\n",
       "      <td>pa0296au_012_211104_065338</td>\n",
       "      <td>0296</td>\n",
       "      <td>2021-11-04</td>\n",
       "      <td>-24.462069</td>\n",
       "      <td>-42.471629</td>\n",
       "      <td>881.503400</td>\n",
       "      <td>G211E</td>\n",
       "      <td>SG656</td>\n",
       "      <td>128000</td>\n",
       "      <td>24</td>\n",
       "      <td>D000342</td>\n",
       "      <td>AMAR-G4</td>\n",
       "      <td>50</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>123321 rows × 14 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                                                              time  \\\n",
       "filename                                                             \n",
       "pa0001au_001_151112_134841_rms_spl3.mat 2015-11-12 13:48:40.999995   \n",
       "pa0001au_002_151112_135041_rms_spl3.mat 2015-11-12 13:50:40.999998   \n",
       "pa0001au_003_151112_135241_rms_spl3.mat 2015-11-12 13:52:41.000001   \n",
       "pa0001au_004_151112_135441_rms_spl3.mat 2015-11-12 13:54:41.000004   \n",
       "pa0002au_001_151112_143618_rms_spl3.mat 2015-11-12 14:36:17.999998   \n",
       "...                                                            ...   \n",
       "pa0296au_008_211104_061338_rms_spl3.mat 2021-11-04 06:13:37.999999   \n",
       "pa0296au_009_211104_062338_rms_spl3.mat 2021-11-04 06:23:38.000003   \n",
       "pa0296au_010_211104_063338_rms_spl3.mat 2021-11-04 06:33:37.999998   \n",
       "pa0296au_011_211104_064338_rms_spl3.mat 2021-11-04 06:43:38.000002   \n",
       "pa0296au_012_211104_065338_rms_spl3.mat 2021-11-04 06:53:37.999997   \n",
       "\n",
       "                                                     filename_mseed mergulho  \\\n",
       "filename                                                                       \n",
       "pa0001au_001_151112_134841_rms_spl3.mat  pa0001au_001_151112_134841     0001   \n",
       "pa0001au_002_151112_135041_rms_spl3.mat  pa0001au_002_151112_135041     0001   \n",
       "pa0001au_003_151112_135241_rms_spl3.mat  pa0001au_003_151112_135241     0001   \n",
       "pa0001au_004_151112_135441_rms_spl3.mat  pa0001au_004_151112_135441     0001   \n",
       "pa0002au_001_151112_143618_rms_spl3.mat  pa0002au_001_151112_143618     0002   \n",
       "...                                                             ...      ...   \n",
       "pa0296au_008_211104_061338_rms_spl3.mat  pa0296au_008_211104_061338     0296   \n",
       "pa0296au_009_211104_062338_rms_spl3.mat  pa0296au_009_211104_062338     0296   \n",
       "pa0296au_010_211104_063338_rms_spl3.mat  pa0296au_010_211104_063338     0296   \n",
       "pa0296au_011_211104_064338_rms_spl3.mat  pa0296au_011_211104_064338     0296   \n",
       "pa0296au_012_211104_065338_rms_spl3.mat  pa0296au_012_211104_065338     0296   \n",
       "\n",
       "                                               date        lat        lon  \\\n",
       "filename                                                                    \n",
       "pa0001au_001_151112_134841_rms_spl3.mat  2015-11-12 -23.825054 -42.495485   \n",
       "pa0001au_002_151112_135041_rms_spl3.mat  2015-11-12 -23.824642 -42.495492   \n",
       "pa0001au_003_151112_135241_rms_spl3.mat  2015-11-12 -23.824228 -42.495501   \n",
       "pa0001au_004_151112_135441_rms_spl3.mat  2015-11-12 -23.823816 -42.495506   \n",
       "pa0002au_001_151112_143618_rms_spl3.mat  2015-11-12 -23.817508 -42.495013   \n",
       "...                                             ...        ...        ...   \n",
       "pa0296au_008_211104_061338_rms_spl3.mat  2021-11-04 -24.458063 -42.470370   \n",
       "pa0296au_009_211104_062338_rms_spl3.mat  2021-11-04 -24.458968 -42.470625   \n",
       "pa0296au_010_211104_063338_rms_spl3.mat  2021-11-04 -24.459786 -42.470928   \n",
       "pa0296au_011_211104_064338_rms_spl3.mat  2021-11-04 -24.460836 -42.471147   \n",
       "pa0296au_012_211104_065338_rms_spl3.mat  2021-11-04 -24.462069 -42.471629   \n",
       "\n",
       "                                                dep station_nettab    N/S  \\\n",
       "filename                                                                    \n",
       "pa0001au_001_151112_134841_rms_spl3.mat    4.364921          G1500  SG618   \n",
       "pa0001au_002_151112_135041_rms_spl3.mat   20.074000          G1500  SG618   \n",
       "pa0001au_003_151112_135241_rms_spl3.mat   37.126000          G1500  SG618   \n",
       "pa0001au_004_151112_135441_rms_spl3.mat   50.867000          G1500  SG618   \n",
       "pa0002au_001_151112_143618_rms_spl3.mat    5.413571          G1500  SG618   \n",
       "...                                             ...            ...    ...   \n",
       "pa0296au_008_211104_061338_rms_spl3.mat  586.134284          G211E  SG656   \n",
       "pa0296au_009_211104_062338_rms_spl3.mat  664.644524          G211E  SG656   \n",
       "pa0296au_010_211104_063338_rms_spl3.mat  741.901279          G211E  SG656   \n",
       "pa0296au_011_211104_064338_rms_spl3.mat  826.451882          G211E  SG656   \n",
       "pa0296au_012_211104_065338_rms_spl3.mat  881.503400          G211E  SG656   \n",
       "\n",
       "                                             Fs  nBits Hidrofone   PreAmp  \\\n",
       "filename                                                                    \n",
       "pa0001au_001_151112_134841_rms_spl3.mat  125000     16    911006     1501   \n",
       "pa0001au_002_151112_135041_rms_spl3.mat  125000     16    911006     1501   \n",
       "pa0001au_003_151112_135241_rms_spl3.mat  125000     16    911006     1501   \n",
       "pa0001au_004_151112_135441_rms_spl3.mat  125000     16    911006     1501   \n",
       "pa0002au_001_151112_143618_rms_spl3.mat  125000     16    911006     1501   \n",
       "...                                         ...    ...       ...      ...   \n",
       "pa0296au_008_211104_061338_rms_spl3.mat  128000     24   D000342  AMAR-G4   \n",
       "pa0296au_009_211104_062338_rms_spl3.mat  128000     24   D000342  AMAR-G4   \n",
       "pa0296au_010_211104_063338_rms_spl3.mat  128000     24   D000342  AMAR-G4   \n",
       "pa0296au_011_211104_064338_rms_spl3.mat  128000     24   D000342  AMAR-G4   \n",
       "pa0296au_012_211104_065338_rms_spl3.mat  128000     24   D000342  AMAR-G4   \n",
       "\n",
       "                                         Ciclo  \n",
       "filename                                        \n",
       "pa0001au_001_151112_134841_rms_spl3.mat      0  \n",
       "pa0001au_002_151112_135041_rms_spl3.mat      0  \n",
       "pa0001au_003_151112_135241_rms_spl3.mat      0  \n",
       "pa0001au_004_151112_135441_rms_spl3.mat      0  \n",
       "pa0002au_001_151112_143618_rms_spl3.mat      0  \n",
       "...                                        ...  \n",
       "pa0296au_008_211104_061338_rms_spl3.mat     50  \n",
       "pa0296au_009_211104_062338_rms_spl3.mat     50  \n",
       "pa0296au_010_211104_063338_rms_spl3.mat     50  \n",
       "pa0296au_011_211104_064338_rms_spl3.mat     50  \n",
       "pa0296au_012_211104_065338_rms_spl3.mat     50  \n",
       "\n",
       "[123321 rows x 14 columns]"
      ]
     },
     "execution_count": 41,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_csv_meanS"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 42,
   "id": "9f820baa-c593-4e2d-9d9d-13dc43b0779a",
   "metadata": {},
   "outputs": [],
   "source": [
    "df_campanha = df_csv_meanS.groupby([\"station_nettab\"]).agg(pd.Series.tolist)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 43,
   "id": "d6011492-2878-46bc-98c5-2c3aaac29665",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>time</th>\n",
       "      <th>filename_mseed</th>\n",
       "      <th>mergulho</th>\n",
       "      <th>date</th>\n",
       "      <th>lat</th>\n",
       "      <th>lon</th>\n",
       "      <th>dep</th>\n",
       "      <th>N/S</th>\n",
       "      <th>Fs</th>\n",
       "      <th>nBits</th>\n",
       "      <th>Hidrofone</th>\n",
       "      <th>PreAmp</th>\n",
       "      <th>Ciclo</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>station_nettab</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>G1500</th>\n",
       "      <td>[2015-11-12 13:48:40.999995, 2015-11-12 13:50:...</td>\n",
       "      <td>[pa0001au_001_151112_134841, pa0001au_002_1511...</td>\n",
       "      <td>[0001, 0001, 0001, 0001, 0002, 0002, 0002, 000...</td>\n",
       "      <td>[2015-11-12, 2015-11-12, 2015-11-12, 2015-11-1...</td>\n",
       "      <td>[-23.825053500000003, -23.8246425, -23.8242279...</td>\n",
       "      <td>[-42.495485, -42.4954925, -42.495501000000004,...</td>\n",
       "      <td>[4.36492065, 20.073999999999998, 37.1260000000...</td>\n",
       "      <td>[SG618, SG618, SG618, SG618, SG618, SG618, SG6...</td>\n",
       "      <td>[125000, 125000, 125000, 125000, 125000, 12500...</td>\n",
       "      <td>[16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 1...</td>\n",
       "      <td>[911006, 911006, 911006, 911006, 911006, 91100...</td>\n",
       "      <td>[1501, 1501, 1501, 1501, 1501, 1501, 1501, 150...</td>\n",
       "      <td>[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>G1601</th>\n",
       "      <td>[2015-12-19 17:36:43.999998, 2016-01-08 10:16:...</td>\n",
       "      <td>[pa0315au_043_151219_173644, pa0001au_002_1601...</td>\n",
       "      <td>[0315, 0001, 0001, 0001, 0002, 0002, 0002, 000...</td>\n",
       "      <td>[2015-12-19, 2016-01-08, 2016-01-08, 2016-01-0...</td>\n",
       "      <td>[-25.0794585, -23.8402455, -23.840843999999997...</td>\n",
       "      <td>[-42.27269, -42.504215, -42.5042725, -42.50433...</td>\n",
       "      <td>[980.93178, 20.937999499999997, 37.24699850000...</td>\n",
       "      <td>[SG618, SG618, SG618, SG618, SG618, SG618, SG6...</td>\n",
       "      <td>[125000, 125000, 125000, 125000, 125000, 12500...</td>\n",
       "      <td>[16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 1...</td>\n",
       "      <td>[911006, 911006, 911006, 911006, 911006, 91100...</td>\n",
       "      <td>[1501, 1501, 1501, 1501, 1501, 1501, 1501, 150...</td>\n",
       "      <td>[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                                                             time  \\\n",
       "station_nettab                                                      \n",
       "G1500           [2015-11-12 13:48:40.999995, 2015-11-12 13:50:...   \n",
       "G1601           [2015-12-19 17:36:43.999998, 2016-01-08 10:16:...   \n",
       "\n",
       "                                                   filename_mseed  \\\n",
       "station_nettab                                                      \n",
       "G1500           [pa0001au_001_151112_134841, pa0001au_002_1511...   \n",
       "G1601           [pa0315au_043_151219_173644, pa0001au_002_1601...   \n",
       "\n",
       "                                                         mergulho  \\\n",
       "station_nettab                                                      \n",
       "G1500           [0001, 0001, 0001, 0001, 0002, 0002, 0002, 000...   \n",
       "G1601           [0315, 0001, 0001, 0001, 0002, 0002, 0002, 000...   \n",
       "\n",
       "                                                             date  \\\n",
       "station_nettab                                                      \n",
       "G1500           [2015-11-12, 2015-11-12, 2015-11-12, 2015-11-1...   \n",
       "G1601           [2015-12-19, 2016-01-08, 2016-01-08, 2016-01-0...   \n",
       "\n",
       "                                                              lat  \\\n",
       "station_nettab                                                      \n",
       "G1500           [-23.825053500000003, -23.8246425, -23.8242279...   \n",
       "G1601           [-25.0794585, -23.8402455, -23.840843999999997...   \n",
       "\n",
       "                                                              lon  \\\n",
       "station_nettab                                                      \n",
       "G1500           [-42.495485, -42.4954925, -42.495501000000004,...   \n",
       "G1601           [-42.27269, -42.504215, -42.5042725, -42.50433...   \n",
       "\n",
       "                                                              dep  \\\n",
       "station_nettab                                                      \n",
       "G1500           [4.36492065, 20.073999999999998, 37.1260000000...   \n",
       "G1601           [980.93178, 20.937999499999997, 37.24699850000...   \n",
       "\n",
       "                                                              N/S  \\\n",
       "station_nettab                                                      \n",
       "G1500           [SG618, SG618, SG618, SG618, SG618, SG618, SG6...   \n",
       "G1601           [SG618, SG618, SG618, SG618, SG618, SG618, SG6...   \n",
       "\n",
       "                                                               Fs  \\\n",
       "station_nettab                                                      \n",
       "G1500           [125000, 125000, 125000, 125000, 125000, 12500...   \n",
       "G1601           [125000, 125000, 125000, 125000, 125000, 12500...   \n",
       "\n",
       "                                                            nBits  \\\n",
       "station_nettab                                                      \n",
       "G1500           [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 1...   \n",
       "G1601           [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 1...   \n",
       "\n",
       "                                                        Hidrofone  \\\n",
       "station_nettab                                                      \n",
       "G1500           [911006, 911006, 911006, 911006, 911006, 91100...   \n",
       "G1601           [911006, 911006, 911006, 911006, 911006, 91100...   \n",
       "\n",
       "                                                           PreAmp  \\\n",
       "station_nettab                                                      \n",
       "G1500           [1501, 1501, 1501, 1501, 1501, 1501, 1501, 150...   \n",
       "G1601           [1501, 1501, 1501, 1501, 1501, 1501, 1501, 150...   \n",
       "\n",
       "                                                            Ciclo  \n",
       "station_nettab                                                     \n",
       "G1500           [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...  \n",
       "G1601           [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...  "
      ]
     },
     "execution_count": 43,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_campanha.head(2)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 44,
   "id": "9e1fedc0",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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55136re//W2n/RueeeYZfepTn9KoUaPkdDpVXFwcOHfhwgXNnz9fn/zkJxUfH6958+Z12abnn39en/70p5WUlKTMzEzde++9Onny5IDcfzis1lcej0ezZs3Sxz/+caWkpOiWW27RSy+9NGD3H45I9pXNZut0bNiwIej7jDFavXq1PvGJTyghIUFZWVkqKysLqvPjH/9Y119/vRITEzVp0iT9/Oc/H9hOCFE0+2r58uVd1vnYxz4W1Kba2lrddNNNGjVqlK699tpO/T1YrNZXjY2NKioq0qRJkxQXF6fS0tKo9EMoovn76r333uuyr3bs2BF0jYsXL+rhhx/W+PHjlZCQoAkTJuhnP/vZwHZECKzWV/Pnz++yzg033BDejZlhYMaMGWbatGlm165d5r333jN79+41ZWVl5sUXXzTGGPOb3/zGjBw50nzxi180L730kjly5IjZu3evefrpp82nPvUpc/r06cC1fvjDH5oxY8aY559/3hw5csT8+c9/Ntu3bw+c//DDD813v/tds3HjRnP77bebuXPndmqP1+s1cXFxpry83Lz77rvG6/WaG264wcybN2+gu6JXVuurkpIS8/jjj5vXXnvNvPPOO2bp0qVmxIgR5o033hjoruhVJPtKkqmoqDCNjY2B49y5c0Hft3DhQjNp0iSzbds28+6775r9+/ebqqqqwPn169eb5ORks2XLFnP06FGzefNmM3r06KA+HyzR7KuWlpagc42NjWby5MnmG9/4RqDOu+++a5KSkkxJSYk5dOiQefrpp82IESNMZWVltLqkW1brq7q6OvPggw+aZ5991tx4442mpKQkSj3Ru2j+vqqrqzOSzB/+8Ieg/rp48WJQm+bMmWOmTZtmqqqqTF1dndm7d6955ZVXotIfPbFaX505cyboXH19vUlNTTXLli0L676GfBBz+vRpI8nU1NR0ef7DDz80aWlp5ktf+lK312hvbzfGGHPq1CmTmJho/vCHP4T03d/4xje6fDA/8cQT5tprrw0q+9GPfmRcLldI1x0oVuyrrkyePNk88sgjIdUdKJHsK2M+eti88MIL3dY9dOiQiY+PN3/5y1+6rXPLLbeYxYsXB5WVlJSYW2+9tdvPREO0++pKb775ppFkXn755UDZkiVLzD/8wz8E1bv//vvN5z73uZCvOxCs2FeXmzlzpmWCmGj/vup4MO/fv7/bOr///e+Nw+EwJ0+eDO0mosSKfXWlF154wdhsNvPee++F/BljjBnyr5NGjx6t0aNH6ze/+Y0uXrzY6fzOnTt18uRJLVmypNtrdGwgWVVVpfb2djU0NOj666+Xy+XSv/7rv6q+vj6sNk2fPl3Hjh3T//zP/8gYow8++ECVlZW64447wru5CLNiX12pvb1dLS0tSk1N7dd1+iuSfdWhuLhY11xzjaZOnaoNGzaovb09cO63v/2trr32Wr344ovKyclRdna2vvWtb+nUqVOBOhcvXtSoUaOCrpmYmKjXXntNly5d6uut9lu0++pKP/nJT/SJT3xCubm5gbJXX31VBQUFQfVuv/12/elPf6Kvrugrqxqs31dz5sxRenq6br31VlVWVgad2759u26++WatWrVKY8eO1Sc+8QktXrxY58+f7+fd9o8V++pKP/3pT/WFL3xB48ePD+/mwgp5YlRlZaW5+uqrzahRo8z06dPN0qVLzVtvvWWMMWblypVGkjl16lSg/muvvWY+9rGPBY7f/va3xhhjVqxYYUaMGGEmTZpkduzYYV599VXzT//0T2bSpEmdhhSN6Xl04de//rUZPXq0iY+PN5LMnDlzTGtra+RvPkxW7KvLrVq1yqSmppoPPvggMjfcD5HqK2OMefTRR83u3bvN/v37zerVq01SUpJ59NFHA+fvv/9+k5CQYKZNm2ZefvllU11dbW688UaTn58fqLN06VLjdDrNn/70J9Pe3m727dtn0tPTjSRz/PjxKPRI96LZV5e7cOGCufrqq83jjz8eVD5x4kTz2GOPBZW98sor9FUXfXU5K43EGBPd31d/+9vfzJo1a8zevXvNvn37zH/913+ZuLg484tf/CJw/dtvv90kJCSYO+64w+zdu9f87ne/M+PHjzf33ntvFHula1brq8sdP37c2O1288tf/jLs+xoWQYwxxpw/f97s3LnTPPLII+aWW24xdrvdVFRUdPkf78KFC+avf/2r+etf/xo0HPvYY48ZSeall14K1D1x4oSJi4szO3bs6PSd3T2YDx48aDIzM82qVavMW2+9ZXbs2GE++clPmm9+85sRv+++sFJfXW7Tpk0mKSkpaB7IYItEX3Vl9erVJiUlJfDzt7/9bSPJHD58OFD2+uuvG0mBV0znzp0z9957r4mPjzd2u92MGTPGLFmyxEiyRNAXrb663KZNm0x8fLxpbGwMKp84caIpKysLKvvjH/9oJHWqOxis1FeXs1oQY8zg/L7qUFxcbD75yU8Gfp41a5YZNWqUOXPmTKBs69atxmazdZrjNhis1FeXKysrM2lpaV3+gdubYRPEXOm+++4z48aNM1u3bjWSzKuvvtplvcv/4/3sZz8zkkx9fX1QnfT0dLNx48ZOn+3uwfy1r33NFBYWBpV5vV5L/BXYlcHsqw5btmwxiYmJgUloVtWXvupKxwO1qanJGGPMD37wAxMfHx9U59y5c0aS2blzZ1B5a2urqa+vN21tbYHJvn6/v383NgAGqq8u9/nPf77LCfO5ubnmwQcfDCrzeDwmPj7eEiOiVxrMvrqcFYOYK0Xj91WH5557zowaNSrw89e//nUzYcKEoDqHDh0yksw777zTxzsaOIPZVx3a29vNddddZ0pLS/t0D0N+Tkx3Jk+erLNnz6qgoECpqal6/PHHe/3MrbfeKkk6fPhwoOzUqVP6+9//HtZ7vHPnzikuLrjr7Xa7JHVKY7OCwewrSdq8ebPmz5+vTZs2Dfq8od70pa+6sn//fo0aNUpXXXWVpI/6s62tTUePHg3UeeeddySpU3+OGDFCLpdLdrtdW7Zs0Z133tnp35sVDFRfdairq1N1dbXuu+++Tp+55ZZbVFVVFVS2c+dO3XzzzRoxYkSf2jGQBrOvYk00f1/t379fmZmZQdc5fvy4Pvzww0DZO++8o7i4OLlcrr7czoAazL7qUFtbqyNHjvT9316fQp8Y8ve//93k5+ebX/ziF+att94y7777rvnVr35lMjIyAq9vPB6PGTFihPniF79oduzYYY4ePWreeust8/jjjxtJQaljc+fONTfccIN55ZVXzIEDB8ydd95pJk+eHPTX28GDB83+/fvNv/zLv5i8vDyzf//+oFnaFRUVJj4+3qxfv94cPXrU/PGPfzQ333yz+cd//Meo9UtXrNhXHUPcP/7xj4PS8S4frh0Mkeyr7du3m40bN5oDBw6YI0eOmKefftqkpKQEjRT4/X7z2c9+1tx2223mjTfeMH/605/MtGnTzKxZswJ1Dh8+bH7xi1+Yd955x+zdu9d89atfNampqaauri6qfXOlaPdVh+9///tmzJgxpq2trdO5jhTr733ve+bQoUPmpz/9qSVSrK3YV8aYwP+XN910kykqKjL79+83Bw8eHLiOCEG0f18988wz5vnnnzeHDh0yf/nLX8wTTzxhRowYYdasWRO4RktLi3G5XKawsNAcPHjQ1NbWmokTJ5pvfetb0e2cK1ixrzp87WtfM9OmTevzvQ35IObChQvmP//zP81nP/tZ43A4TFJSkpk0aZL5/ve/H/SOct++faawsNCkp6eb+Ph4k5aWZm6//XazZcuWoJRFn89nvvnNb5qrrrrKpKammi996Uvm/fffD/rO8ePHG0mdjsv96Ec/MpMnTzaJiYkmMzPT/Nu//Zs5duzYwHZGL6zYVzNnzuzy/OXrWAyGSPbV73//e3PjjTea0aNHm6SkJDNlyhSzdu1ac+nSpaDvbGhoMG6324wePdpkZGSY+fPnB6VyHjp0yNx4440mMTHRpKSkmLlz5/aYkh0tg9FXfr/fuFwu89BDD3XbrpqaGvOZz3zGjBw50mRnZ5snn3xyYDogDFbtq67+Hxw/fvyA9EGoov376plnnjHXX3+9SUpKMsnJyeamm27qcqLq//7v/5ovfOELJjEx0bhcLrNo0aJBnw9j1b46c+aMSUxM7PE1VG9sxljw/QUAAEAvrPeiHAAAIAQEMQAAICYRxAAAgJhEEAMAAGISQQwAAIhJBDEAACAmEcQAAICYRBADAABiEkEMAACISQQxAAAgJhHEAACAmEQQAwAAYtL/AxSz+jeXry79AAAAAElFTkSuQmCC",
      "text/plain": [
       "<Figure size 640x480 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "plt.figure()\n",
    "for i in df_campanha.iterrows():\n",
    "    plt.plot(i[1]['N/S'][0],i[1].time[0],'ok')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 45,
   "id": "9f57e3bc-8385-4874-bf2f-a06557f8e622",
   "metadata": {},
   "outputs": [],
   "source": [
    "def mergulho_start_end_time(k):\n",
    "    try:\n",
    "        files_mseed_HD = [i for i in filenames_MSEED if i.split('/')[-1].split('.')[0] in k[1]['filename_mseed']]\n",
    "        \n",
    "        tr_start = obspy.read(files_mseed_HD[0],headonly=True)[0]\n",
    "\n",
    "        tr_end = obspy.read(files_mseed_HD[-1],headonly=True)[0]\n",
    "        \n",
    "        filename_mseed_HD = [i.split('/')[-1].split('.')[0] for i in files_mseed_HD]\n",
    "        df_file = k[1].to_frame()\n",
    "\n",
    "        df_nettab = df_file.T\n",
    "        df_nettab['station_nettab'] = k[0]\n",
    "        df_nettab['date_start_nettab'] = tr_start.stats.starttime.strftime('%Y/%j:%H%M')\n",
    "        df_nettab['date_end_nettab'] = tr_end.stats.endtime.strftime('%Y/%j:%H%M')\n",
    "        df_nettab['filename_mseed_HD'] = [filename_mseed_HD]\n",
    "        df_nettab['start_lat'] = k[1]['lat'][0]\n",
    "        df_nettab['end_lat'] = k[1]['lat'][-1]\n",
    "        df_nettab['start_lon'] = k[1]['lon'][0]\n",
    "        df_nettab['end_lon'] = k[1]['lon'][-1]\n",
    "        df_nettab['ciclo'] = k[1]['Ciclo'][0]\n",
    "        df_nettab['Fs'] = k[1]['Fs'][0]\n",
    "        df_nettab['nBits'] = k[1]['nBits'][0]        \n",
    "\n",
    "        #Modelo do Glider\n",
    "        df_nettab['N/S'] = [k[1]['N/S']]\n",
    "        df_nettab['modelo'] = k[1]['N/S'][0] \n",
    "\n",
    "\n",
    "        #Modelo do Sensor\n",
    "        df_nettab['hidrofone'] = [k[1]['Hidrofone']]\n",
    "        if '9' in k[1]['Hidrofone'][0]:\n",
    "            df_nettab['sensor'] = 'HTI_92_WB'\n",
    "        if 'D' in k[1]['Hidrofone'][0]:\n",
    "            df_nettab['sensor'] = 'M36-V35-100'\n",
    "\n",
    "        #Modelo do Registrador\n",
    "        df_nettab['preAmp'] = [k[1]['PreAmp']]\n",
    "        if '1' in k[1]['PreAmp'][0]:\n",
    "            df_nettab['registrador'] = 'EOS_HM1'\n",
    "        else:\n",
    "            df_nettab['registrador'] = k[1]['PreAmp'][0]\n",
    "\n",
    "        return df_nettab\n",
    "    \n",
    "    except:\n",
    "        pass"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b4f00d66-c5cc-4f68-b2e5-85c4b2cbb667",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      " 67%|████████████████████████████████████████████████████████████████████████████████▋                                        | 32/48 [01:05<00:17,  1.07s/it]"
     ]
    }
   ],
   "source": [
    "end_time = []\n",
    "with Pool(processes=4) as p:\n",
    "    with tqdm(total=len(df_campanha)) as pbar:\n",
    "        for result in p.imap(mergulho_start_end_time,df_campanha.iterrows()):\n",
    "            pbar.update()\n",
    "            end_time.append(result)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "42d12610-b329-44d1-b4d6-70d1db5d3658",
   "metadata": {
    "scrolled": true
   },
   "outputs": [],
   "source": [
    "dataframe_campanha_mseed_final = pd.concat(end_time, ignore_index=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "414a25bd-d8f0-48b0-a725-c465a66e8448",
   "metadata": {},
   "outputs": [],
   "source": [
    "dataframe_campanha_mseed_final.head(4).sort_values(by='ciclo')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "91d3dde9",
   "metadata": {},
   "outputs": [],
   "source": [
    "lines_nettab = []\n",
    "for i in dataframe_campanha_mseed_final.iterrows():\n",
    "    # Station lines (one line per station/sensor/epoch) # code description datalogger%sn seismometer%sn # sampling orientation lat. lon. elev. depth. start end\n",
    "    #Sl: UNAP \"Uni-Iquique/Chile\"   DM24%A1383 CMG-3ESP/60%T34622 100 ZNE -20.24393 -70.14041 0.0    0.0 2009/134 \n",
    "    lines_nettab.append('Sl: '+str(i[1]['station_nettab'])+' \"C'+str(i[1]['ciclo']).zfill(2)+':'+i[1]['modelo']+'\" '+i[1]['registrador']+' '+str(i[1]['sensor'])+' 100 H '+str(i[1]['start_lat'])[:8]+' '+str(i[1]['start_lon'])[:8]+' 0 0 '+i[1]['date_start_nettab']+' '+i[1]['date_end_nettab'])\n",
    "    print('Sl: '+str(i[1]['station_nettab'])+' \"C'+str(i[1]['ciclo']).zfill(2)+':'+i[1]['modelo']+'\" '+i[1]['registrador']+' '+i[1]['sensor']+' 100 H '+str(i[1]['start_lat'])[:8]+' '+str(i[1]['start_lon'])[:8]+' 0 0 '+i[1]['date_start_nettab']+' '+i[1]['date_end_nettab'])"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "5b30c8ae-3fe3-4133-a3ce-b92b199aa1a6",
   "metadata": {},
   "source": [
    "# Salvando o arquivo de NETTAB e o DATAFRAME:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "197cbdc8-e917-417a-978c-15e5f81be398",
   "metadata": {},
   "outputs": [],
   "source": [
    "with open('/media/sysop/8d2362fc-3b46-49a7-a864-19b2a6ad097b/diogoloc/dados_posdoc/gliders_project/OUTPUT/NETTAB/df_campanha_glider_nettab.txt', 'w') as f:\n",
    "    for line in lines_nettab:\n",
    "        f.write(line)\n",
    "        f.write('\\n')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c89f77a8-e31d-4ebb-bed9-06a6b00a14de",
   "metadata": {},
   "outputs": [],
   "source": [
    "dataframe_campanha_mseed_final.to_feather('/media/sysop/8d2362fc-3b46-49a7-a864-19b2a6ad097b/diogoloc/dados_posdoc/gliders_project/OUTPUT/NETTAB/df_campanha_glider.feather')"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "2cb4b8e9-6921-4389-8fbe-7a9a76e29fe0",
   "metadata": {},
   "source": [
    "# Renomeando os arquivos \".mseed\":"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "0f260d7b-9266-4868-9376-1903f22b3855",
   "metadata": {},
   "outputs": [],
   "source": [
    "dataframe_campanha_mseed_final_rows = [row for idx,row in dataframe_campanha_mseed_final.iterrows()]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "4044bcf2-1d29-4df0-b94e-1a7d4fd7181f",
   "metadata": {},
   "outputs": [],
   "source": [
    "def get_rename_files(row):\n",
    "    \n",
    "    files_mseed_HD = row['filename_mseed_HD']\n",
    "    \n",
    "    files_path_mseed_HD = [glob.glob(MSEED_INPUT+'*/*/'+i+'.mseed') for i in files_mseed_HD]\n",
    "\n",
    "    return [files_path_mseed_HD]\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1960c98d-f957-414a-90f9-f1ff454399ee",
   "metadata": {},
   "outputs": [],
   "source": [
    "rename_files_lst = []\n",
    "with Pool(processes=4) as p:\n",
    "    with tqdm(total=len(df_campanha)) as pbar:\n",
    "        for result in p.imap(get_rename_files,dataframe_campanha_mseed_final_rows):\n",
    "            pbar.update()\n",
    "            rename_files_lst.append(result)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "935246ea-0dbc-4a66-bf4d-c9cdfbdc6d73",
   "metadata": {},
   "outputs": [],
   "source": [
    "def rename_files(row):\n",
    "    \n",
    "    files_mseed_HD = row['filename_mseed_HD']\n",
    "\n",
    "    \n",
    "    files_path_mseed_HD = [glob.glob(MSEED_INPUT+'*/*/'+i+'.mseed') for i in files_mseed_HD]\n",
    "    \n",
    "    for y in files_path_mseed_HD:\n",
    "        \n",
    "        st = obspy.read(y[0])\n",
    "        st[0].stats.network = 'GL'\n",
    "        st[0].stats.station = k['station_nettab']\n",
    "        st[0].stats.channel = 'HHH'\n",
    "\n",
    "        #<SDSdir>/Year/NET/STA/CHAN.TYPE/NET.STA.LOC.CHAN.TYPE.YEAR.DAY\n",
    "        #Saving in SDS structure        \n",
    "        OUTPUT_STREAM = FOLDER_OUTPUT+'MSEED_GL_SDS/'+st[0].stats.starttime.strftime(\"%Y\")+'/'+st[0].stats.network+'/'+st[0].stats.station+'/HHH.D/'\n",
    "        os.makedirs(OUTPUT_STREAM,exist_ok=True)\n",
    "        \n",
    "        station_name_file = st[0].stats.network+'.'+st[0].stats.station+'..'+st[0].stats.channel+'.D.'+st[0].stats.starttime.strftime(\"%Y.%j.%H.%M.%S\")+'.mseed'\n",
    "        if os.path.exists(OUTPUT_STREAM+station_name_file) == False:\n",
    "            st.write(OUTPUT_STREAM+station_name_file, format='MSEED')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b270339f-ed94-408e-a724-8a110cfb638d",
   "metadata": {},
   "outputs": [],
   "source": [
    "with Pool(processes=4) as p:\n",
    "    with tqdm(total=len(dataframe_campanha_mseed_final[:1])) as pbar:\n",
    "        for result in p.imap_unordered(rename_files,dataframe_campanha_mseed_final_rows[:1]):\n",
    "            pbar.update()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "dbbd3df4-f5a7-4bb6-be78-9c2d097d010f",
   "metadata": {},
   "outputs": [],
   "source": [
    "len(dataframe_campanha_mseed_final_rows)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "88a95099-9258-4c48-8f3f-af6ea28f696a",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.11.6"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
